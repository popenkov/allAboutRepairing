"use strict";document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelector(".js-hamburger-btn"),t=document.querySelector(".js-hamburger-menu"),o=document.querySelector(".hamburger__back-btn-mobile");document.querySelector(".header__hamburger-btn-mobile.change");e.addEventListener("click",(function(){console.log("click"),t.classList.toggle("hamburger-show")})),o.addEventListener("click",(function(){console.log("click"),t.classList.remove("hamburger-show")})),function(e,t,o,n){var i=document.querySelectorAll(e),r=document.querySelector(o),s=document.querySelectorAll(n);function l(e){for(var t=e;t<s.length;t++)s[t].classList.remove("show"),s[t].classList.add("hide")}l(1),r.addEventListener("click",(function(o){var n,r=o.target;if(console.log(r,!!r.closest(e)),r.closest(t)||r.classList.contains(t))for(var c=0;c<i.length;c++)if(r==i[c]){console.log(i[c]),l(0),s[n=c].classList.contains("hide")&&(s[n].classList.remove("hide"),s[n].classList.add("show"));break}}))}(".hamburger__left-menu-item-link",".hamburger__left-menu-item",".hamburger__left-menu",".hamburger__right-menu-item");var n=document.querySelector(".header__location"),i=document.querySelector(".header__location-popup");n&&n.addEventListener("click",(function(e){e.preventDefault(),i.classList.toggle("header__location-popup--show")}));var r=document.querySelector(".header__hamburger-btn-mobile"),s=document.querySelector(".header__navigation-container");document.querySelector("main"),document.querySelector("body");r&&r.addEventListener("click",(function(e){e.preventDefault(),r.classList.toggle("change"),s.classList.toggle("show"),t.classList.remove("hamburger-show")}));new Swiper(".main__slider-swiper",{direction:"horizontal",loop:!0,navigation:{nextEl:".main__slider-button-next",prevEl:".main__slider-button-prev"}}),new Swiper(".pop-works__slider-swiper",{direction:"horizontal",loop:!0,slidesPerView:3,spaceBetween:24,navigation:{nextEl:".pop-works__slider-button-next",prevEl:".pop-works__slider-button-prev"},breakpoints:{700:{slidesPerView:1,spaceBetween:0},1150:{slidesPerView:2,spaceBetween:24},1440:{slidesPerView:3,spaceBetween:24}}}),new Swiper(".new-videos__slider-swiper",{direction:"horizontal",loop:!0,slidesPerView:4,spaceBetween:24,loopAdditionalSlides:3,navigation:{nextEl:".new-videos__slider-button-next",prevEl:".new-videos__slider-button-prev"},breakpoints:{600:{slidesPerView:1.36,spaceBetween:24},800:{slidesPerView:2,spaceBetween:24},1150:{slidesPerView:3,spaceBetween:24}}});var l,c=document.body.clientWidth,a=document.querySelector(".pop-articles__items-swiper"),d=function(){console.log("sliderInit"),l=new Swiper(".pop-articles__items-swiper",{direction:"horizontal",loop:!0,slidesPerView:1.35,spaceBetween:20,loopAdditionalSlides:3}),a.classList.remove("pop-articles--no-swiper")};c<769&&d();window.addEventListener("resize",(function(){var e=document.body.clientWidth;console.log(e),e<769?d():e>=769&&a.classList.contains("swiper-container-initialized")&&(console.log("swiperDestroy"),l.destroy(!0,!0),a.classList.add("pop-articles--no-swiper"))})),console.log(c);var u=document.querySelectorAll(".popup-link"),p=document.querySelector("body"),m=document.querySelectorAll(".lock-padding"),g=!0;if(u.length>0)for(var h=function(e){var t=u[e];t.addEventListener("click",(function(e){var o=t.getAttribute("href").replace("#",""),n=document.getElementById(o);console.log(n),function(e){if(e&&g){var t=document.querySelector(".popup.open");t?y(t,!1):function(){var e=window.innerWidth-document.querySelector(".wrapper").clientWidth+"px";if(console.log(window.innerWidth),console.log(document.querySelector(".wrapper").offsetWidth),m.length>0)for(var t=0;t<m.length;t++){m[t].style.paddingRight=e}p.style.paddingRight=e,p.classList.add("lock"),g=!1,setTimeout((function(){g=!0}),800)}(),e.classList.add("open"),e.addEventListener("click",(function(e){e.target.closest(".popup__content")||y(e.target.closest(".popup"))}))}}(n),e.preventDefault()}))},w=0;w<u.length;w++)h(w);var v=document.querySelectorAll(".close-popup");if(v.length>0)for(var f=function(e){var t=v[e];t.addEventListener("click",(function(e){y(t.closest(".popup")),e.preventDefault()}))},_=0;_<v.length;_++)f(_);function y(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.querySelector("form")&&e.querySelector("form").reset(),g&&(e.classList.remove("open"),t&&b())}function b(){setTimeout((function(){if(m.length>0)for(var e=0;e<m.length;e++){m[e].style.paddingRight="0px"}p.style.paddingRight="0px",p.classList.remove("lock")}),800),g=!1,setTimeout((function(){g=!0}),800)}document.addEventListener("keydown",(function(e){27==e.which&&y(document.querySelector(".popup.open"))}))}));
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbW1vbi5qcyJdLCJuYW1lcyI6WyJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJoYW1idXJnZXJCYWNrQnRuIiwicXVlcnlTZWxlY3RvciIsImhhbWJlcmdlckNsb3NlQnRuIiwiY2F0YWxvZ0J1dHRvbiIsImNvbnNvbGUiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJxdWVyeVNlbGVjdG9yQWxsIiwibG9nIiwiaGFtYnVyZ2VyTWVudSIsImhpZGVUYWJDb250ZW50IiwicmVtb3ZlIiwiYnV0dG9uIiwiYnV0dG9uQ29udGFpbmVyIiwiYnRuQ29udGFpbmVyIiwidGFiIiwidGFiQnV0dG9uIiwiYnV0dG9uc0NvbnRhaW5lciIsInRhYkNvbnRlbnQiLCJjb250YWlucyIsImFkZCIsImkiLCJhIiwibGVuZ3RoIiwiZXZ0IiwiYiIsInRhcmdldCIsImNsb3Nlc3QiLCJoZWFkZXJMb2NhdGlvbkxpbmsiLCJoZWFkZXJMb2NhdGlvblBvcHVwIiwic2hvd1RhYkNvbnRlbnQiLCJtZW51Q29udGFpbmVyIiwiaGVhZGVyQnV0dG9uTW9iaWxlIiwicHJldmVudERlZmF1bHQiLCJzaG93TWVudSIsImUiLCJTd2lwZXIiLCJkaXJlY3Rpb24iLCJsb29wIiwibmF2aWdhdGlvbiIsIm5leHRFbCIsInNsaWRlc1BlclZpZXciLCJzcGFjZUJldHdlZW4iLCJwcmV2RWwiLCJzd2lwZXJDb250YWluZXIiLCJNQVhfTU9CSUxFX1dJRFRIIiwic2xpZGVySW5pdCIsIjExNTAiLCIxNDQwIiwiY2xpZW50V2lkdGgiLCJyZXNpemVIYW5kbGVyU2xpZGVyIiwiYnJlYWtwb2ludHMiLCI4MDAiLCJwb3BBcnRpY2xlc1N3aXBlciIsImJvZHkiLCJsb29wQWRkaXRpb25hbFNsaWRlcyIsIndpbmRvdyIsImN1cnJlbnRQb3B1cCIsInBvcHVwT3BlbiIsImxvY2tQYWRkaW5nIiwidW5sb2NrIiwiZGVzdHJveSIsInBvcHVwQ2xvc2VJY29uIiwicG9wdXBBY3RpdmUiLCJib2R5VW5sb2NrIiwiX2xvb3AiLCJwb3B1cExpbmsiLCJwb3B1cExpbmtzIiwicG9wdXBOYW1lIiwiZ2V0QXR0cmlidXRlIiwicmVwbGFjZSIsImdldEVsZW1lbnRCeUlkIiwic2V0VGltZW91dCIsImxvY2tQYWRkaW5nVmFsdWUiLCJpbm5lcldpZHRoIiwib2Zmc2V0V2lkdGgiLCJzdHlsZSIsInBhZGRpbmdSaWdodCIsImJvZHlMb2NrIiwicG9wdXBDbG9zZSIsImVsIiwiX2xvb3AyIiwiZG9VbmxvY2siLCJhcmd1bWVudHMiLCJ1bmRlZmluZWQiLCJyZXNldCIsIndoaWNoIl0sIm1hcHBpbmdzIjoiYUFFQUEsU0FBU0MsaUJBQWlCLG9CQUFvQixXQVF6QyxJQUFNQyxFQUFtQkYsU0FBU0csY0FBYyxxQkFDMUNDLEVBQW9CSixTQUFTRyxjQUFjLHNCQUUvQ0UsRUFBZ0JBLFNBQWNKLGNBQWlCLCtCQUNoREQsU0FBQUcsY0FBQSx3Q0FEREUsRUFBQUosaUJBQUEsU0FBQSxXQVVFQyxRQUFBQSxJQUFBQSxTQUNESSxFQUFZQyxVQUFaQyxPQUFBLHFCQVltQlIsRUFBU1MsaUJBRjFCLFNBQUEsV0FWRkgsUUFBUUksSUFBSSxTQWNWQyxFQUFTQyxVQUFUQyxPQUE0QixxQkFQaEMsU0FBb0JDLEVBQVFDLEVBQWlCQyxFQUFjQyxHQUd2RCxJQUFJQyxFQUFZbEIsU0FBU1MsaUJBQWlCSyxHQWUxQ0ssRUFBNEJuQixTQUFBRyxjQUFBYSxHQUNwQkksRUFBY2IsU0FBVWMsaUJBQTVCSixHQUVJRyxTQUFBQSxFQUF3QkUsR0FDM0IsSUFBQSxJQUFBQyxFQUFBQyxFQUFBRCxFQUFBSCxFQUFBSyxPQUFBRixJQUdMSCxFQUFBRyxHQUFBaEIsVUFBQU0sT0FBQSxRQWZRTyxFQUFXRyxHQUFHaEIsVUFBVWUsSUFBSSxRQUtwQ1YsRUFBZSxHQVdmTyxFQUFBbEIsaUJBQUEsU0FBQSxTQUFBeUIsR0FpQkMsSUFaa0NDLEVBWWxDQyxFQUFBRixFQUFBRSxPQUdTLEdBbEJadEIsUUFBUUksSUFBSWtCLElBQVVBLEVBQU9DLFFBQVFmLElB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QUEsRUFBQUEsU0FFL0JwRCxHQWpFRyxJQUFNMkQsRUFBS2xCLEVBQWV6QyxHQW1FbkJ3RCxFQUFBQSxpQkFBZUosU0FBQUEsU0FBMUJqRCxHQUNlSixFQWxCQzRELEVBb0JoQnJELFFBQUEsV0FuRVFILEVBQUlTLHFCQThEWFosRUFBQSxFQUFBQSxFQUFBeUMsRUFBQXZDLE9BQUFGLElBQUE0RCxFQUFBNUQsR0FvQ0EsU0FBQTBELEVBQUFoQixHQUFBLElBQUFtQixJQUFBQyxVQUFBNUQsT0FBQSxRQUFBNkQsSUFBQUQsVUFBQSxLQUFBQSxVQUFBLEdBSkxwQixFQUFBOUQsY0FBQSxTQXJoQlI4RCxFQUFBOUQsY0FBQSxRQUFBb0YsUUEwZGdCekIsSUFDQUcsRUFBWTFELFVBQVVNLE9BQU8sUUFDekJ1RSxHQUNBbEIsS0FzQ1osU0FBU0EsSUFDTFEsWUFBVyxXQUNQLEdBQUliLEVBQVlwQyxPQUFTLEVBQ3JCLElBQUssSUFBSUYsRUFBSSxFQUFHQSxFQUFJc0MsRUFBWXBDLE9BQVFGLElBQUssQ0FDOUJzQyxFQUFZdEMsR0FDcEJ1RCxNQUFNQyxhQUFlLE1BR2hDdkIsRUFBS3NCLE1BQU1DLGFBQWUsTUFDMUJ2QixFQUFLakQsVUFBVU0sT0FBTyxVQTdHZCxLQWdIWmlELEdBQVMsRUFDVFksWUFBVyxXQUNQWixHQUFTLElBbEhELEtBc0hoQjlELFNBQVNDLGlCQUFpQixXQUFXLFNBQVV5QixHQUMxQixJQUFiQSxFQUFJOEQsT0FFSlAsRUFEb0JqRixTQUFTRyxjQUFjIiwiZmlsZSI6ImNvbW1vbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxyXG5cclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgXHJcbiAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAgIC8vPT09PT09PXwgICBJTVBPUlRTXHJcbiAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAgIFxyXG4gICAgXHRjb25zdCBjYXRhbG9nQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLWhhbWJ1cmdlci1idG4nKTtcclxuICAgIFx0Y29uc3QgaGFtYnVyZ2VyTWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy1oYW1idXJnZXItbWVudScpO1xyXG4gICAgXHRjb25zdCBoYW1idXJnZXJCYWNrQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhhbWJ1cmdlcl9fYmFjay1idG4tbW9iaWxlJyk7XHJcbiAgICBcdGNvbnN0IGhhbWJlcmdlckNsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9faGFtYnVyZ2VyLWJ0bi1tb2JpbGUuY2hhbmdlJyk7XHJcbiAgICBcdFxyXG4gICAgXHQhIWNhdGFsb2dCdXR0b24gJiBjYXRhbG9nQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgXHRcdGNvbnNvbGUubG9nKCdjbGljaycpXHJcbiAgICBcdFx0aGFtYnVyZ2VyTWVudS5jbGFzc0xpc3QudG9nZ2xlKCdoYW1idXJnZXItc2hvdycpO1xyXG4gICAgXHJcbiAgICBcdFxyXG4gICAgXHRcclxuICAgIFx0fSk7XHJcbiAgICBcclxuICAgIFxyXG4gICAgXHRcclxuICAgIFx0ISFoYW1idXJnZXJCYWNrQnRuICYgaGFtYnVyZ2VyQmFja0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgIFx0XHRjb25zb2xlLmxvZygnY2xpY2snKVxyXG4gICAgXHRcdGhhbWJ1cmdlck1lbnUuY2xhc3NMaXN0LnJlbW92ZSgnaGFtYnVyZ2VyLXNob3cnKTtcclxuICAgIFx0fSk7XHJcbiAgICBcclxuICAgIFx0XHJcbiAgICBcclxuICAgIFxyXG4gICAgZnVuY3Rpb24gdGFiTW9kdWxlIChidXR0b24sIGJ1dHRvbkNvbnRhaW5lciwgYnRuQ29udGFpbmVyLCB0YWIpIHtcclxuICAgIFxyXG4gICAgICAgIC8v0L3Rg9C20L3QviDQvdCw0LnRgtC4INC60L3QvtC/0LrQuCwg0LHQu9C+0Log0LrQvtC90YLQtdC90YLQsCDQuCDQsdC70L7QuiBjINC60L3QvtC/0LrQsNC80LhcclxuICAgICAgICBsZXQgdGFiQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChidXR0b24pLFxyXG4gICAgICAgICAgICBidXR0b25zQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihidG5Db250YWluZXIpLFxyXG4gICAgICAgICAgICB0YWJDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh0YWIpO1xyXG4gICAgXHJcbiAgICAgICAgZnVuY3Rpb24gaGlkZVRhYkNvbnRlbnQgKGEpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IGE7IGk8IHRhYkNvbnRlbnQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHRhYkNvbnRlbnRbaV0uY2xhc3NMaXN0LnJlbW92ZSgnc2hvdycpO1xyXG4gICAgICAgICAgICAgICAgdGFiQ29udGVudFtpXS5jbGFzc0xpc3QuYWRkKCdoaWRlJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAvL9GB0LrRgNGL0LLQsNC10Lwg0LLRgdC1INGC0LDQsdGLLCDQutGA0L7QvNC1INC/0LXRgNCy0L7Qs9C+XHJcbiAgICAgICAgaGlkZVRhYkNvbnRlbnQoMSk7XHJcbiAgICBcclxuICAgICAgICAvL9C/0L7QutCw0Lcg0L7Qv9GA0LXQtNC10LvQtdC90L3QvtCz0L4g0YLQsNCx0LBcclxuICAgICAgICBmdW5jdGlvbiBzaG93VGFiQ29udGVudCAoYikge1xyXG4gICAgICAgICAgICBpZiAodGFiQ29udGVudFtiXS5jbGFzc0xpc3QuY29udGFpbnMoJ2hpZGUnKSkge1xyXG4gICAgICAgICAgICAgICAgdGFiQ29udGVudFtiXS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlJyk7XHJcbiAgICAgICAgICAgICAgICB0YWJDb250ZW50W2JdLmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIC8v0L7QsdGA0LDQsdC+0YLRh9C40Log0LrQu9C40LrQsFxyXG4gICAgICAgIGJ1dHRvbnNDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZ0KSB7XHJcbiAgICAgICAgICAgIGxldCB0YXJnZXQgPSBldnQudGFyZ2V0O1xyXG4gICAgXHRcdGNvbnNvbGUubG9nKHRhcmdldCwgISF0YXJnZXQuY2xvc2VzdChidXR0b24pKVxyXG4gICAgICAgICAgICBpZih0YXJnZXQuY2xvc2VzdChidXR0b25Db250YWluZXIpfHwgdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhidXR0b25Db250YWluZXIpKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaTx0YWJCdXR0b24ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0ID09IHRhYkJ1dHRvbltpXSkge1xyXG4gICAgXHRcdFx0XHRcdGNvbnNvbGUubG9nKHRhYkJ1dHRvbltpXSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGlkZVRhYkNvbnRlbnQoMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNob3dUYWJDb250ZW50KGkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgXHJcbiAgICAgICAgfSlcclxuICAgIFxyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIFxyXG4gICAgICAgIHRhYk1vZHVsZSgnLmhhbWJ1cmdlcl9fbGVmdC1tZW51LWl0ZW0tbGluaycsICcuaGFtYnVyZ2VyX19sZWZ0LW1lbnUtaXRlbScsICcuaGFtYnVyZ2VyX19sZWZ0LW1lbnUnLCAnLmhhbWJ1cmdlcl9fcmlnaHQtbWVudS1pdGVtJyk7XHJcbiAgICBcclxuICAgIFxyXG4gICAgXHJcbiAgICBcdGNvbnN0IGhlYWRlckxvY2F0aW9uTGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfX2xvY2F0aW9uJyk7XHJcbiAgICBjb25zdCBoZWFkZXJMb2NhdGlvblBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9fbG9jYXRpb24tcG9wdXAnKTtcclxuICAgIFxyXG4gICAgISFoZWFkZXJMb2NhdGlvbkxpbmsgJiYgaGVhZGVyTG9jYXRpb25MaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgaGVhZGVyTG9jYXRpb25Qb3B1cC5jbGFzc0xpc3QudG9nZ2xlKCdoZWFkZXJfX2xvY2F0aW9uLXBvcHVwLS1zaG93Jyk7XHJcbiAgICB9KVxyXG4gICAgXHJcbiAgICBcclxuICAgIFxyXG4gICAgXHJcbiAgICBjb25zdCBoZWFkZXJCdXR0b25Nb2JpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX19oYW1idXJnZXItYnRuLW1vYmlsZScpO1xyXG4gICAgY29uc3QgbWVudUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfX25hdmlnYXRpb24tY29udGFpbmVyJyk7XHJcbiAgICBjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbWFpbicpO1xyXG4gICAgY29uc3Qgc2l0ZUJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XHJcbiAgICAgXHJcbiAgICBcclxuICAgIFxyXG4gICAgXHJcbiAgICBjb25zdCB0b29nbGVIYW1idXJnZXI9KCkgPT4ge1xyXG4gICAgICAgIGhlYWRlckJ1dHRvbk1vYmlsZS5jbGFzc0xpc3QudG9nZ2xlKFwiY2hhbmdlXCIpO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgY29uc3Qgc2hvd01lbnUgPSAoKSA9PiB7XHJcbiAgICAgICAgbWVudUNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdzaG93Jyk7XHJcbiAgICAgICAgLyogc2l0ZUJvZHkuY2xhc3NMaXN0LnRvZ2dsZSgnYm9keV9fbm8tc2Nyb2xsJyk7ICovXHJcbiAgICBcclxuICAgIH1cclxuICAgIFxyXG4gICAgXHJcbiAgICAhIWhlYWRlckJ1dHRvbk1vYmlsZSAmJiBoZWFkZXJCdXR0b25Nb2JpbGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB0b29nbGVIYW1idXJnZXIoKTtcclxuICAgICAgICBzaG93TWVudSgpO1xyXG4gICAgXHJcbiAgICBcdGhhbWJ1cmdlck1lbnUuY2xhc3NMaXN0LnJlbW92ZSgnaGFtYnVyZ2VyLXNob3cnKTtcclxuICAgIFx0XHJcbiAgICBcclxuICAgIFxyXG4gICAgXHJcbiAgICB9KVxyXG4gICAgXHJcbiAgICAvKiBcdGNvbnN0IG1vYmlsZUNhdGFsb2dCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGFtYnVyZXItYnRuLS1tb2JpbGUnKTtcclxuICAgIFx0ISFtb2JpbGVDYXRhbG9nQnRuICYgbW9iaWxlQ2F0YWxvZ0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgIFx0XHRjb25zb2xlLmxvZygnY2xpY2snKVxyXG4gICAgXHRcdGhhbWJ1cmdlck1lbnUuY2xhc3NMaXN0LnRvZ2dsZSgnLm1vYmlsZS1tZW51LS1zaG93ICcpO1xyXG4gICAgXHR9KVxyXG4gICAgICovXHJcbiAgICBcclxuICAgIFxyXG4gICAgLyogXHRjb25zdCBsZWZ0TWVudUl0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmhhbWJ1cmdlcl9fbGVmdC1tZW51LWl0ZW0nKVxyXG4gICAgXHRjb25zdCByaWdodE1lbnVDb250YWluZXJJdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5oYW1idXJnZXJfX3JpZ2h0LW1lbnUtaXRlbScpXHJcbiAgICBcclxuICAgIFx0Y29uc3QgaGlkZVJpZ2h0TWVudUl0ZW1zID0gKCkgPT4ge1xyXG4gICAgXHRcdHJpZ2h0TWVudUNvbnRhaW5lckl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICBcdFx0XHRpdGVtLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICBcdFx0fSlcclxuICAgIFx0fVxyXG4gICAgXHJcbiAgICBcclxuICAgIFx0bGVmdE1lbnVJdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgXHRcdGl0ZW0ucXVlcnlTZWxlY3RvcignYScpLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlb3ZlcicsIChlKSA9PiB7XHJcbiAgICBcdFx0XHRoaWRlUmlnaHRNZW51SXRlbXMoKTtcclxuICAgIFx0XHRcdGxldCBpbmRleCA9IGUudGFyZ2V0LmhyZWY7XHJcbiAgICBcdFx0XHRjb25zb2xlLmxvZyhpbmRleClcclxuICAgIFxyXG4gICAgXHRcdH0pXHJcbiAgICBcdH0pXHJcbiAgICBcdGxlZnRNZW51SXRlbXNbMF0uY2xhc3NMaXN0LmFkZCgnc2VsZWN0Jyk7XHJcbiAgICBcdHJpZ2h0TWVudUNvbnRhaW5lckl0ZW1zWzBdLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG4gICAgXHJcbiAgICBcclxuICAgIFxyXG4gICAgXHQvKlxyXG4gICAgXHQkKCcudGFiLW5hdiBhJykubW91c2VvdmVyKGZ1bmN0aW9uKCl7IFxyXG4gICAgXHQgICQoJy50YWItcGFuZWxzPmRpdicpLmhpZGUoKS5maWx0ZXIodGhpcy5oYXNoKS5zaG93KCk7XHJcbiAgICBcdCAgJCgnLnRhYi1uYXYgbGknKS5yZW1vdmVDbGFzcygnc2VsZWN0Jyk7IFxyXG4gICAgXHQgICQodGhpcykucGFyZW50KCkuYWRkQ2xhc3MoJ3NlbGVjdCcpO1xyXG4gICAgXHQgIHJldHVybiAoZmFsc2UpO1xyXG4gICAgXHR9KVxyXG4gICAgICAgKi9cclxuICAgIFxyXG4gICAgXHJcbiAgICBcclxuICAgIFxyXG4gICAgLyogXHJcbiAgICBcclxuICAgIFxyXG4gICAgXHRjb25zdCBjYXRhbG9nQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLWhhbWJ1cmdlci1idG4nKTtcclxuICAgIFx0Y29uc3QgaGFtYnVyZ2VyTWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy1oYW1idXJnZXItbWVudScpO1xyXG4gICAgXHRcclxuICAgIFx0ISFjYXRhbG9nQnV0dG9uICYgY2F0YWxvZ0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgIFx0XHRoYW1idXJnZXJNZW51LmNsYXNzTGlzdC50b2dnbGUoJ2hhbWJ1cmdlci1zaG93Jyk7XHJcbiAgICBcclxuICAgIFxyXG4gICAgXHRcdGNvbnN0IGxlZnRNZW51U3dpcGVyID0gbmV3IFN3aXBlcignLmhhbWJ1cmdlcl9fbGVmdC1tZW51Jywge1xyXG4gICAgXHRcdFx0ZGlyZWN0aW9uOiAndmVydGljYWwnLFxyXG4gICAgXHRcdFx0c2xpZGVzUGVyVmlldzogMSxcclxuICAgIFx0XHQgICBzbGlkZXNQZXJWaWV3OiAnYXV0bycsXHJcbiAgICBcdFx0ICAgYWxsb3dUb3VjaE1vdmU6IGZhbHNlLFxyXG4gICAgXHRcdCAgbG9vcDogZmFsc2UsXHJcbiAgICBcdFx0ICBzbGlkZUFjdGl2ZUNsYXNzOiAnc3dpcGVyLXNsaWRlLWFjdGl2ZScsXHJcbiAgICBcdFx0ICAgXHQgXHJcbiAgICBcdFx0ICAgc2Nyb2xsYmFyOiB7XHJcbiAgICBcdFx0XHQgZWw6ICcuc3dpcGVyLXNjcm9sbGJhcicsXHJcbiAgICBcdFx0XHQgZHJhZ2dhYmxlOiB0cnVlLFxyXG4gICAgXHRcdFx0IGhpZGU6IHRydWUsXHJcbiAgICBcdFx0ICAgfSxcclxuICAgIFxyXG4gICAgXHJcbiAgICBcdFx0ICAgXHJcbiAgICBcdFx0IH0pO1xyXG4gICAgXHJcbiAgICBcdFx0XHJcbiAgICBcdFx0IGNvbnN0IGxlZnRTd2lwZXJTbGlkZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaGFtYnVyZ2VyX19sZWZ0LW1lbnUgLnN3aXBlci13cmFwcGVyIC5zd2lwZXItc2xpZGUnKTtcclxuICAgIFx0XHQgbGVmdE1lbnVTd2lwZXIub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuICAgIFx0XHRcdGxlZnRTd2lwZXJTbGlkZXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgIFx0XHRcdFx0aXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdzd2lwZXItc2xpZGUtYWN0aXZlJyk7XHJcbiAgICBcdFx0XHR9KVxyXG4gICAgXHRcdFx0IGxldCB0YXJnZXQgPSBlLnRhcmdldDtcclxuICAgIFx0XHRcdCB0YXJnZXQuY2xhc3NMaXN0LmFkZCgnc3dpcGVyLXNsaWRlLWFjdGl2ZScpXHJcbiAgICBcdFx0ICB9KTtcclxuICAgIFxyXG4gICAgXHRcdCAgXHJcbiAgICBcclxuICAgIFxyXG4gICAgXHJcbiAgICBcclxuICAgIFx0XHQgXHJcbiAgICBcdCBcclxuICAgIFx0XHQgY29uc3QgcmlnaHRNZW51U3dpcGVyID0gbmV3IFN3aXBlcignLmhhbWJ1cmdlcl9fcmlnaHQtbWVudScsIHtcclxuICAgIFx0XHQgICBcclxuICAgIFx0XHQgICBzbGlkZXNQZXJWaWV3OiAxLFxyXG4gICAgXHRcdCAgIHNwYWNlQmV0d2VlbjogNTAsXHJcbiAgICBcdFx0ICAgZGlyZWN0aW9uOiAndmVydGljYWwnLFxyXG4gICAgXHRcdCAgIGFsbG93VG91Y2hNb3ZlOiBmYWxzZSxcclxuICAgIFx0XHRcdCBsb29wOiBmYWxzZSxcclxuICAgIFx0XHRcdCB0aHVtYnM6IHtcclxuICAgIFx0XHRcdCBzd2lwZXI6IGxlZnRNZW51U3dpcGVyLFxyXG4gICAgXHRcdFx0IH0sXHJcbiAgICBcdCBcclxuICAgIFx0IFxyXG4gICAgXHQgXHJcbiAgICBcdFx0IH0pO1xyXG4gICAgXHR9KVxyXG4gICAgXHRcclxuICAgIFxyXG4gICAgXHJcbiAgICBcdFxyXG4gICAgXHRcclxuICAgIFx0ICovXHJcbiAgICBjb25zdCBtYWluU2xpZGVyc3dpcGVyID0gbmV3IFN3aXBlcignLm1haW5fX3NsaWRlci1zd2lwZXInLCB7XHJcbiAgICAgICAgLy8gT3B0aW9uYWwgcGFyYW1ldGVyc1xyXG4gICAgICAgIGRpcmVjdGlvbjogJ2hvcml6b250YWwnLFxyXG4gICAgICAgIGxvb3A6IHRydWUsXHJcbiAgICAgIFxyXG4gICAgXHJcbiAgICAgICAgLy8gTmF2aWdhdGlvbiBhcnJvd3NcclxuICAgICAgICBuYXZpZ2F0aW9uOiB7XHJcbiAgICAgICAgICBuZXh0RWw6ICcubWFpbl9fc2xpZGVyLWJ1dHRvbi1uZXh0JyxcclxuICAgICAgICAgIHByZXZFbDogJy5tYWluX19zbGlkZXItYnV0dG9uLXByZXYnLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIFxyXG4gICAgICB9KTtcclxuICAgIGNvbnN0IHBvcFdvcmtzU3dpcGVyID0gbmV3IFN3aXBlcignLnBvcC13b3Jrc19fc2xpZGVyLXN3aXBlcicsIHtcclxuICAgICAgICAvLyBPcHRpb25hbCBwYXJhbWV0ZXJzXHJcbiAgICAgICAgZGlyZWN0aW9uOiAnaG9yaXpvbnRhbCcsXHJcbiAgICAgICAgbG9vcDogdHJ1ZSxcclxuICAgIFxyXG4gICAgICAgIC8vIERlZmF1bHQgcGFyYW1ldGVyc1xyXG4gICAgICAgIHNsaWRlc1BlclZpZXc6IDMsXHJcbiAgICAgICAgc3BhY2VCZXR3ZWVuOiAyNCxcclxuICAgICAgIFxyXG4gICAgICBcclxuICAgIFxyXG4gICAgICAgIC8vIE5hdmlnYXRpb24gYXJyb3dzXHJcbiAgICAgICAgbmF2aWdhdGlvbjoge1xyXG4gICAgICAgICAgbmV4dEVsOiAnLnBvcC13b3Jrc19fc2xpZGVyLWJ1dHRvbi1uZXh0JyxcclxuICAgICAgICAgIHByZXZFbDogJy5wb3Atd29ya3NfX3NsaWRlci1idXR0b24tcHJldicsXHJcbiAgICAgICAgfSxcclxuICAgIFxyXG4gICAgICAgIGJyZWFrcG9pbnRzOiB7XHJcbiAgICAgICAgICAvLyB3aGVuIHdpbmRvdyB3aWR0aCBpcyA+PSA0MTR4XHJcbiAgICAgICAgICA3MDA6IHtcclxuICAgICAgICAgICAgc2xpZGVzUGVyVmlldzogMSxcclxuICAgICAgICAgICAgc3BhY2VCZXR3ZWVuOiAwLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIC8vIHdoZW4gd2luZG93IHdpZHRoIGlzID49IDQ4MHB4XHJcbiAgICAgICAgICAxMTUwOiB7XHJcbiAgICAgICAgICAgIHNsaWRlc1BlclZpZXc6IDIsXHJcbiAgICAgICAgICAgIHNwYWNlQmV0d2VlbjogMjQsXHJcbiAgICAgICAgICB9LFxyXG4gICAgXHJcbiAgICBcclxuICAgICAgICAgIDE0NDA6IHtcclxuICAgICAgICAgICAgc2xpZGVzUGVyVmlldzogMyxcclxuICAgICAgICAgICAgc3BhY2VCZXR3ZWVuOiAyNCxcclxuICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIH0pO1xyXG4gICAgY29uc3QgbmV3VmlkZW9zU3dpcGVyID0gbmV3IFN3aXBlcignLm5ldy12aWRlb3NfX3NsaWRlci1zd2lwZXInLCB7XHJcbiAgICAgICAgLy8gT3B0aW9uYWwgcGFyYW1ldGVyc1xyXG4gICAgICAgIGRpcmVjdGlvbjogJ2hvcml6b250YWwnLFxyXG4gICAgICAgIGxvb3A6IHRydWUsXHJcbiAgICAgICAgc2xpZGVzUGVyVmlldzogNCxcclxuICAgICAgICBzcGFjZUJldHdlZW46IDI0LFxyXG4gICAgICAgIGxvb3BBZGRpdGlvbmFsU2xpZGVzOiAzLFxyXG4gICAgICBcclxuICAgIFxyXG4gICAgICAgIC8vIE5hdmlnYXRpb24gYXJyb3dzXHJcbiAgICAgICAgbmF2aWdhdGlvbjoge1xyXG4gICAgICAgICAgbmV4dEVsOiAnLm5ldy12aWRlb3NfX3NsaWRlci1idXR0b24tbmV4dCcsXHJcbiAgICAgICAgICBwcmV2RWw6ICcubmV3LXZpZGVvc19fc2xpZGVyLWJ1dHRvbi1wcmV2JyxcclxuICAgICAgICB9LFxyXG4gICAgXHJcbiAgICBcclxuICAgICAgICBicmVha3BvaW50czoge1xyXG4gICAgICAgICAgLy8gd2hlbiB3aW5kb3cgd2lkdGggaXMgPj0gNDE0XHJcbiAgICAgICAgICA2MDA6IHtcclxuICAgICAgICAgICAgc2xpZGVzUGVyVmlldzogMS4zNixcclxuICAgICAgICAgICAgc3BhY2VCZXR3ZWVuOiAyNFxyXG4gICAgICAgICAgfSxcclxuICAgIFxyXG4gICAgICAgICAgODAwOiB7XHJcbiAgICAgICAgICAgIHNsaWRlc1BlclZpZXc6IDIsXHJcbiAgICAgICAgICAgIHNwYWNlQmV0d2VlbjogMjRcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICAvLyB3aGVuIHdpbmRvdyB3aWR0aCBpcyA+PSAxMDAwXHJcbiAgICAgICAgICAxMTUwOiB7XHJcbiAgICAgICAgICAgIHNsaWRlc1BlclZpZXc6IDMsXHJcbiAgICAgICAgICAgIHNwYWNlQmV0d2VlbjogMjRcclxuICAgICAgICAgIH0sXHJcbiAgICBcclxuICAgICAgICB9XHJcbiAgICAgIFxyXG4gICAgICB9KTtcclxuICAgIGxldCB7IGNsaWVudFdpZHRoIH0gPSBkb2N1bWVudC5ib2R5O1xyXG4gICAgY29uc3Qgc3dpcGVyQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcC1hcnRpY2xlc19faXRlbXMtc3dpcGVyJyk7XHJcbiAgICBsZXQgcG9wQXJ0aWNsZXNTd2lwZXI7XHJcbiAgICBjb25zdCBNQVhfTU9CSUxFX1dJRFRIID0gNzY5O1xyXG4gICAgXHJcbiAgICBjb25zdCBzbGlkZXJJbml0ID0gKCkgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdzbGlkZXJJbml0JylcclxuICAgICAgICBwb3BBcnRpY2xlc1N3aXBlciAgPSBuZXcgU3dpcGVyKCcucG9wLWFydGljbGVzX19pdGVtcy1zd2lwZXInLCB7XHJcbiAgICAgICAgICAgIC8vIE9wdGlvbmFsIHBhcmFtZXRlcnNcclxuICAgICAgICAgICAgZGlyZWN0aW9uOiAnaG9yaXpvbnRhbCcsXHJcbiAgICAgICAgICAgIGxvb3A6IHRydWUsXHJcbiAgICAgICAgICAgIHNsaWRlc1BlclZpZXc6IDEuMzUsXHJcbiAgICAgICAgICAgIHNwYWNlQmV0d2VlbjogMjAsXHJcbiAgICAgICAgICAgIGxvb3BBZGRpdGlvbmFsU2xpZGVzOiAzXHJcbiAgICAgICAgICBcclxuICAgICAgICB9KVxyXG4gICAgXHJcbiAgICAgIFxyXG4gICAgICBcclxuICAgIFxyXG4gICAgICBzd2lwZXJDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgncG9wLWFydGljbGVzLS1uby1zd2lwZXInKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3Qgc3dpcGVyRGVzdHJveSA9ICgpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZygnc3dpcGVyRGVzdHJveScpXHJcbiAgICAgICAgcG9wQXJ0aWNsZXNTd2lwZXIuZGVzdHJveSh0cnVlLCB0cnVlKVxyXG4gICAgICAgIHN3aXBlckNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdwb3AtYXJ0aWNsZXMtLW5vLXN3aXBlcicpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBcclxuICAgIGlmIChjbGllbnRXaWR0aDwgTUFYX01PQklMRV9XSURUSCkge1xyXG4gICAgICAgIHNsaWRlckluaXQoKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgcmVzaXplSGFuZGxlclNsaWRlciA9ICgpID0+IHtcclxuICAgICAgICBsZXQgeyBjbGllbnRXaWR0aCB9ID0gZG9jdW1lbnQuYm9keTtcclxuICAgICAgICBjb25zb2xlLmxvZyhjbGllbnRXaWR0aCk7XHJcbiAgICAgICAgaWYgKGNsaWVudFdpZHRoPCBNQVhfTU9CSUxFX1dJRFRIKSB7XHJcbiAgICAgICAgICAgIHNsaWRlckluaXQoKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGNsaWVudFdpZHRoID49IE1BWF9NT0JJTEVfV0lEVEggJiYgc3dpcGVyQ29udGFpbmVyLmNsYXNzTGlzdC5jb250YWlucygnc3dpcGVyLWNvbnRhaW5lci1pbml0aWFsaXplZCcpKSB7XHJcbiAgICBcclxuICAgICAgICAgICAgc3dpcGVyRGVzdHJveSgpOyBcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCByZXNpemVIYW5kbGVyU2xpZGVyKTtcclxuICAgIFxyXG4gICAgXHJcbiAgICBcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coY2xpZW50V2lkdGgpO1xyXG4gICAgLyogY29uc3QgaGVhZGVyTG9jYXRpb25MaW5rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9fbG9jYXRpb24nKTtcclxuICAgIGNvbnN0IGhlYWRlckxvY2F0aW9uUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX19sb2NhdGlvbi1wb3B1cCcpO1xyXG4gICAgXHJcbiAgICAhIWhlYWRlckxvY2F0aW9uTGluayAmJiBoZWFkZXJMb2NhdGlvbkxpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBoZWFkZXJMb2NhdGlvblBvcHVwLmNsYXNzTGlzdC50b2dnbGUoJ2hlYWRlcl9fbG9jYXRpb24tcG9wdXAtLXNob3cnKTtcclxuICAgIH0pXHJcbiAgICBcclxuICAgIFxyXG4gICAgXHJcbiAgICBcclxuICAgIGNvbnN0IGhlYWRlckJ1dHRvbk1vYmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfX2hhbWJ1cmdlci1idG4tbW9iaWxlJyk7XHJcbiAgICBjb25zdCBtZW51Q29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9fbmF2aWdhdGlvbi1jb250YWluZXInKTtcclxuICAgIGNvbnN0IG1haW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtYWluJyk7XHJcbiAgICBjb25zdCBzaXRlQm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKTtcclxuICAgICBcclxuICAgIFxyXG4gICAgXHJcbiAgICBcclxuICAgIGNvbnN0IHRvb2dsZUhhbWJ1cmdlcj0oKSA9PiB7XHJcbiAgICAgICAgaGVhZGVyQnV0dG9uTW9iaWxlLmNsYXNzTGlzdC50b2dnbGUoXCJjaGFuZ2VcIik7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBjb25zdCBzaG93TWVudSA9ICgpID0+IHtcclxuICAgICAgICBtZW51Q29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ3Nob3cnKTtcclxuICAgICAgICBzaXRlQm9keS5jbGFzc0xpc3QudG9nZ2xlKCdib2R5X19uby1zY3JvbGwnKTtcclxuICAgIFxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBcclxuICAgICEhaGVhZGVyQnV0dG9uTW9iaWxlICYmIGhlYWRlckJ1dHRvbk1vYmlsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHRvb2dsZUhhbWJ1cmdlcigpO1xyXG4gICAgICAgIHNob3dNZW51KCk7XHJcbiAgICBcclxuICAgIFxyXG4gICAgXHJcbiAgICB9KSAqL1xyXG4gICAgXHJcbiAgICBcclxuICAgICAgICBjb25zdCBwb3B1cExpbmtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cC1saW5rXCIpO1xyXG4gICAgICAgIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiYm9keVwiKTtcclxuICAgICAgICBjb25zdCBsb2NrUGFkZGluZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubG9jay1wYWRkaW5nXCIpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCB1bmxvY2sgPSB0cnVlOyAvL9GH0YLQvtCx0Ysg0L3QtSDQsdGL0LvQviDQtNCy0L7QudC90YvRhSDQvdCw0LbQsNGC0LjQuVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IHRpbWVvdXQgPSA4MDA7IC8vINCi0LDQudC80LDRg9GCINGB0YLQvtC40YIg0YLQsNC60L7QuSDQttC1INC60LDQuiDRgyDQsNC90LjQvNCw0YbQuNC4INCyINGB0LjRjdGB0Y3RgS4g0K3RgtC+INGB0LLRj9C30LDQvdC+INGBINCx0LvQvtC60LjRgNC+0LLQutC+0Lkg0YHRgtGA0L7QuNC70LAg0Lgg0LXQs9C+INCw0LTQtdC60LLQsNGC0L3QvtC5INGA0LDQsdC+0YLQtVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChwb3B1cExpbmtzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb3B1cExpbmtzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwb3B1cExpbmsgPSBwb3B1cExpbmtzW2ldO1xyXG4gICAgICAgICAgICAgICAgcG9wdXBMaW5rLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZXZ0KSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcG9wdXBOYW1lID0gcG9wdXBMaW5rLmdldEF0dHJpYnV0ZShcImhyZWZcIikucmVwbGFjZShcIiNcIiwgXCJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFBvcHVwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocG9wdXBOYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhjdXJyZW50UG9wdXApXHJcbiAgICAgICAgICAgICAgICAgICAgcG9wdXBPcGVuKGN1cnJlbnRQb3B1cCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IHBvcHVwQ2xvc2VJY29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jbG9zZS1wb3B1cFwiKTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAocG9wdXBDbG9zZUljb24ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBvcHVwQ2xvc2VJY29uLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBlbCA9IHBvcHVwQ2xvc2VJY29uW2ldO1xyXG4gICAgICAgICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChldnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBwb3B1cENsb3NlKGVsLmNsb3Nlc3QoXCIucG9wdXBcIikpOyAvLyDQmtC70L7Qt9C10YHRgiAtINGN0YLQviDQsdC70LjQttCw0LnRiNC40Lkg0YDQvtC00LjRgtC10LvRjCDRgdGB0YvQu9C60Lgg0YEg0LrQu9Cw0YHRgdC+0Lwg0L/QvtC/0LDQvy4g0KLQviDQtdGB0YLRjCDQsdGD0LTQtdGCINC30LDQutGA0YvRgiDQv9C+0L/QsNC/INGA0Y/QtNC+0Lwg0YEg0LrQu9C40LrQvdGD0YLQvtC5INGB0YHRi9C70LrQvtC5LCDQsCDQvdC1INC60LDQutC+0YbRgtC+INC00YDRg9Cz0L7QuS4g0J7RgiDRgdGB0YvQu9C60Lgg0YHQvtCx0YvRgtC40LUg0LLRgdC/0LvRi9Cy0ZHRgiDQuCDRgdGA0LDQsdC+0YLQsNC10YIg0L3QsCDRgNC+0LTQuNGC0LXQu9C1INGBINC60LvQsNGB0YHQvtC8INC/0L7Qv9Cw0L9cclxuICAgICAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy/RhNGD0L3QutGG0LjRjyDQvtGC0LrRgNGL0YLQuNGPXHJcbiAgICAgICAgXHJcbiAgICAgICAgZnVuY3Rpb24gcG9wdXBPcGVuKGN1cnJlbnRQb3B1cCkge1xyXG4gICAgICAgICAgICAvL9CS0L3QsNGH0LDQu9C1INC/0YDQvtCy0LXRgNC60LAg0L3QsCDRg9C20LUg0L7RgtC60YDRi9GC0YvQtSDQv9C+0L/QsNC/0YssINGH0YLQvtCx0Ysg0LfQsNC60YDRi9GC0Ywg0LjRhVxyXG4gICAgICAgICAgICBpZiAoY3VycmVudFBvcHVwICYmIHVubG9jaykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcG9wdXBBY3RpdmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwLm9wZW5cIik7XHJcbiAgICAgICAgICAgICAgICBpZiAocG9wdXBBY3RpdmUpIHtcclxuICAgICAgICAgICAgICAgICAgICBwb3B1cENsb3NlKHBvcHVwQWN0aXZlLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGJvZHlMb2NrKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50UG9wdXAuY2xhc3NMaXN0LmFkZChcIm9wZW5cIik7XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvL9C30LDQutGA0YvRgtC40LUg0L/QviDQutC70LjQutGDINCy0L3QtSDQvtCx0LvQsNGB0YLQuCDQutC+0L3RgtC10L3RgtCwXHJcbiAgICAgICAgICAgICAgICBjdXJyZW50UG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChldnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWV2dC50YXJnZXQuY2xvc2VzdChcIi5wb3B1cF9fY29udGVudFwiKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3B1cENsb3NlKGV2dC50YXJnZXQuY2xvc2VzdChcIi5wb3B1cFwiKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgXHJcbiAgICAgICAgLy/QpNCj0J3QmtCm0JjQryDQl9CQ0JrQoNCr0KLQmNCvXHJcbiAgICAgICAgLy/QkiDQt9Cw0LrRgNGL0YLQuNC4INC80Ysg0LzQvtC20LXQvCDQv9C10YDQtdC00LDRgtGMINGE0L7Qu9GBINC00LvRjyDQsdC70L7QutC40YDQvtCy0LrQuCDQsdC+0LTQuCwg0LrQvtCz0LTQsCDQvNGLINC+0YLQutGA0YvQstCw0LXQvCDQv9C+0L/QsNC/INCyINC/0L7Qv9Cw0L/QtVxyXG4gICAgICAgIGZ1bmN0aW9uIHBvcHVwQ2xvc2UocG9wdXBBY3RpdmUsIGRvVW5sb2NrID0gdHJ1ZSkge1xyXG4gICAgICAgICAgICBpZiAocG9wdXBBY3RpdmUucXVlcnlTZWxlY3RvcignZm9ybScpKSB7XHJcbiAgICAgICAgICAgICAgICBwb3B1cEFjdGl2ZS5xdWVyeVNlbGVjdG9yKCdmb3JtJykucmVzZXQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvKiBwb3B1cEFjdGl2ZS5xdWVyeVNlbGVjdG9yKCdmb3JtJykucmVzZXQoKTsgKi9cclxuICAgICAgICAgICAgaWYgKHVubG9jaykge1xyXG4gICAgICAgICAgICAgICAgcG9wdXBBY3RpdmUuY2xhc3NMaXN0LnJlbW92ZShcIm9wZW5cIik7XHJcbiAgICAgICAgICAgICAgICBpZiAoZG9VbmxvY2spIHtcclxuICAgICAgICAgICAgICAgICAgICBib2R5VW5sb2NrKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgXHJcbiAgICAgICAgXHJcbiAgICAgICAgXHJcbiAgICAgICAgXHJcbiAgICAgICAgZnVuY3Rpb24gYm9keUxvY2soKSB7XHJcbiAgICAgICAgICAgIC8v0JLQvdCw0YfQsNC70LUg0YPQsdC40YDQsNC10YIg0L/RgNGL0LPQsNGO0YnQuNC5INGB0LrRgNC+0LvQuyB3cmFwcGVyIOKAkyDRjdGC0L4g0LTQuNCyINCy0L3Rg9GC0YDQuCDQsdC+0LTQuFxyXG4gICAgICAgICAgICAvKiBjb25zdCBsb2NrUGFkZGluZ1ZhbHVlID0gd2luZG93LmlubmVyV2lkdGggLSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLndyYXBwZXJcIikub2Zmc2V0V2lkdGggKyBcInB4XCI7ICovXHJcbiAgICAgICAgICAgIGNvbnN0IGxvY2tQYWRkaW5nVmFsdWUgPSB3aW5kb3cuaW5uZXJXaWR0aCAtIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud3JhcHBlclwiKS5jbGllbnRXaWR0aCArIFwicHhcIjtcclxuICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICAgICAgY29uc29sZS5sb2cod2luZG93LmlubmVyV2lkdGgpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLndyYXBwZXJcIikub2Zmc2V0V2lkdGgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgICAvL9Cb0L7QuiDQv9GN0LTQtNC40L3QsyDQtNC+0LHQsNCy0LvRj9C10YIg0L7QsdGK0LXQutGC0LDQvCDRgSDQv9C+0LfQuNGI0L0g0YTQuNC60YHQtC4g0J3QsNC/0YDQuNC80LXRgCDRhdGN0LTRjdGAINGC0LDQutC+0LkuINCe0L0g0YHQstC40LTQs9Cw0LXRgtGB0Y8uINCV0LzRgyDQvdCw0LTQviDRgdGC0LjQu9GMINC/0L7QtNC/0YDQsNCy0LjRgtGMLlxyXG4gICAgICAgICAgICBpZiAobG9ja1BhZGRpbmcubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsb2NrUGFkZGluZy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVsID0gbG9ja1BhZGRpbmdbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgZWwuc3R5bGUucGFkZGluZ1JpZ2h0ID0gbG9ja1BhZGRpbmdWYWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgICAgICBib2R5LnN0eWxlLnBhZGRpbmdSaWdodCA9IGxvY2tQYWRkaW5nVmFsdWU7XHJcbiAgICAgICAgICAgIGJvZHkuY2xhc3NMaXN0LmFkZChcImxvY2tcIik7XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgIC8v0J7QvSDQu9C+0YfQuNGCINC90LAg0LLRgNC10LzRjyDRgtCw0LnQvNCw0YPRgtCwLCDQv9C+0YLQvtC80YMg0YfRgtC+INC+0LrQvdC+INC30LDQutGA0YvQstCw0LXRgtGB0Y8gODAwINC80YEuINCYINGH0YLQvtCx0Ysg0LLQviDQstGA0LXQvNGPINC30LDQutGA0YvRgtC40Y8g0L3QtSDQvtGC0LrRgNGL0YLRjCDQsdGL0LvQviDQvtC60L3QviDRgdC90L7QstCwXHJcbiAgICAgICAgICAgIHVubG9jayA9IGZhbHNlO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHVubG9jayA9IHRydWU7XHJcbiAgICAgICAgICAgIH0sIHRpbWVvdXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICAvL9C90LUg0LTQviDQutC+0L3RhtCwXHJcbiAgICAgICAgZnVuY3Rpb24gYm9keVVubG9jaygpIHtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobG9ja1BhZGRpbmcubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbG9ja1BhZGRpbmcubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZWwgPSBsb2NrUGFkZGluZ1tpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWwuc3R5bGUucGFkZGluZ1JpZ2h0ID0gXCIwcHhcIjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBib2R5LnN0eWxlLnBhZGRpbmdSaWdodCA9IFwiMHB4XCI7XHJcbiAgICAgICAgICAgICAgICBib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ2xvY2snKTtcclxuICAgICAgICAgICAgfSwgdGltZW91dCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgIHVubG9jayA9IGZhbHNlO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHVubG9jayA9IHRydWU7XHJcbiAgICAgICAgICAgIH0sIHRpbWVvdXQpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbiAoZXZ0KSB7XHJcbiAgICAgICAgICAgIGlmIChldnQud2hpY2ggPT0gMjcpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBvcHVwQWN0aXZlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cC5vcGVuXCIpO1xyXG4gICAgICAgICAgICAgICAgcG9wdXBDbG9zZShwb3B1cEFjdGl2ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIFxyXG5cclxufSk7Il19
