"use strict";document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelector(".js-hamburger-btn"),t=document.querySelector(".js-hamburger-menu"),o=document.querySelector(".hamburger__back-btn-mobile");document.querySelector(".header__hamburger-btn-mobile.change");e.addEventListener("click",(function(){console.log("click"),t.classList.toggle("hamburger-show"),l.classList.toggle("body__no-scroll")})),o.addEventListener("click",(function(){console.log("click"),t.classList.remove("hamburger-show")})),function(e,t,o,n){var r=document.querySelectorAll(e),i=document.querySelector(o),s=document.querySelectorAll(n);function l(e){for(var t=e;t<s.length;t++)s[t].classList.remove("show"),s[t].classList.add("hide")}l(1),i.addEventListener("click",(function(o){var n,i=o.target;if(console.log(i,!!i.closest(e)),i.closest(t)||i.classList.contains(t))for(var c=0;c<r.length;c++)if(i==r[c]){console.log(r[c]),l(0),s[n=c].classList.contains("hide")&&(s[n].classList.remove("hide"),s[n].classList.add("show"));break}}))}(".hamburger__left-menu-item-link",".hamburger__left-menu-item",".hamburger__left-menu",".hamburger__right-menu-item");var n=document.querySelector(".header__location"),r=document.querySelector(".header__location-popup");n&&n.addEventListener("click",(function(e){e.preventDefault(),r.classList.toggle("header__location-popup--show")}));var i=document.querySelector(".header__hamburger-btn-mobile"),s=document.querySelector(".header__navigation-container"),l=(document.querySelector("main"),document.querySelector("body"));i&&i.addEventListener("click",(function(e){e.preventDefault(),i.classList.toggle("change"),s.classList.toggle("show"),l.classList.toggle("body__no-scroll"),t.classList.remove("hamburger-show")}));new Swiper(".main__slider-swiper",{direction:"horizontal",loop:!0,navigation:{nextEl:".main__slider-button-next",prevEl:".main__slider-button-prev"}}),new Swiper(".pop-works__slider-swiper",{direction:"horizontal",loop:!0,slidesPerView:3,spaceBetween:24,navigation:{nextEl:".pop-works__slider-button-next",prevEl:".pop-works__slider-button-prev"},breakpoints:{700:{slidesPerView:1,spaceBetween:0},1150:{slidesPerView:2,spaceBetween:24},1440:{slidesPerView:3,spaceBetween:24}}}),new Swiper(".new-videos__slider-swiper",{direction:"horizontal",loop:!0,slidesPerView:4,spaceBetween:24,loopAdditionalSlides:3,navigation:{nextEl:".new-videos__slider-button-next",prevEl:".new-videos__slider-button-prev"},breakpoints:{600:{slidesPerView:1.36,spaceBetween:24},800:{slidesPerView:2,spaceBetween:24},1150:{slidesPerView:3,spaceBetween:24}}});var c,a=document.body.clientWidth,d=document.querySelector(".pop-articles__items-swiper"),u=document.querySelector(".pop-articles__items"),p=function(){console.log("sliderInit"),c=new Swiper(".pop-articles__items-swiper",{direction:"horizontal",loop:!0,slidesPerView:1.35,spaceBetween:20,loopAdditionalSlides:3,breakpoints:{620:{slidesPerView:1.35,spaceBetween:20},768:{slidesPerView:2,spaceBetween:24}}}),d.classList.remove("pop-articles--no-swiper")};a<769&&!d.classList.contains("swiper-container-initialized")&&p();window.addEventListener("resize",(function(){var e=document.body.clientWidth;console.log(e),e<769?p():(console.log("swiperDestroy",c),c.destroy(),c.data("swiper").destroy(),c.swiper().destroy(),c=null,d.classList.add("pop-articles--no-swiper"),u.removeAttribute("style"),u.childNodes.forEach((function(e){return e.removeAttribute("style")})),u.style=" ")})),console.log(a);var m=document.querySelectorAll(".popup-link"),g=document.querySelector("body"),w=document.querySelectorAll(".lock-padding"),h=!0;if(m.length>0)for(var v=function(e){var t=m[e];t.addEventListener("click",(function(e){var o=t.getAttribute("href").replace("#",""),n=document.getElementById(o);console.log(n),function(e){if(e&&h){var t=document.querySelector(".popup.open");t?L(t,!1):function(){var e=window.innerWidth-document.querySelector(".wrapper").clientWidth+"px";if(console.log(window.innerWidth),console.log(document.querySelector(".wrapper").offsetWidth),w.length>0)for(var t=0;t<w.length;t++){w[t].style.paddingRight=e}g.style.paddingRight=e,g.classList.add("lock"),h=!1,setTimeout((function(){h=!0}),800)}(),e.classList.add("open"),e.addEventListener("click",(function(e){e.target.closest(".popup__content")||L(e.target.closest(".popup"))}))}}(n),e.preventDefault()}))},_=0;_<m.length;_++)v(_);var f=document.querySelectorAll(".close-popup");if(f.length>0)for(var y=function(e){var t=f[e];t.addEventListener("click",(function(e){L(t.closest(".popup")),e.preventDefault()}))},b=0;b<f.length;b++)y(b);function L(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.querySelector("form")&&e.querySelector("form").reset(),h&&(e.classList.remove("open"),t&&S())}function S(){setTimeout((function(){if(w.length>0)for(var e=0;e<w.length;e++){w[e].style.paddingRight="0px"}g.style.paddingRight="0px",g.classList.remove("lock")}),800),h=!1,setTimeout((function(){h=!0}),800)}document.addEventListener("keydown",(function(e){27==e.which&&L(document.querySelector(".popup.open"))}))}));
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbW1vbi5qcyJdLCJuYW1lcyI6WyJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJoYW1idXJnZXJCYWNrQnRuIiwicXVlcnlTZWxlY3RvciIsImhhbWJlcmdlckNsb3NlQnRuIiwiY2F0YWxvZ0J1dHRvbiIsInRvZ2dsZSIsImNvbnNvbGUiLCJsb2ciLCJjbGFzc0xpc3QiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaGFtYnVyZ2VyTWVudSIsImhpZGVUYWJDb250ZW50IiwicmVtb3ZlIiwiYnV0dG9uIiwiYnV0dG9uQ29udGFpbmVyIiwiYnRuQ29udGFpbmVyIiwidGFiIiwidGFiQnV0dG9uIiwiYnV0dG9uc0NvbnRhaW5lciIsInRhYkNvbnRlbnQiLCJjb250YWlucyIsImFkZCIsImkiLCJhIiwibGVuZ3RoIiwiZXZ0IiwiYiIsInRhcmdldCIsImNsb3Nlc3QiLCJoZWFkZXJMb2NhdGlvbkxpbmsiLCJoZWFkZXJMb2NhdGlvblBvcHVwIiwic2hvd1RhYkNvbnRlbnQiLCJtZW51Q29udGFpbmVyIiwiaGVhZGVyQnV0dG9uTW9iaWxlIiwicHJldmVudERlZmF1bHQiLCJzaG93TWVudSIsImUiLCJzaXRlQm9keSIsIlN3aXBlciIsInNsaWRlc1BlclZpZXciLCJzcGFjZUJldHdlZW4iLCJuZXh0RWwiLCJwcmV2RWwiLCJkaXJlY3Rpb24iLCJsb29wIiwibmF2aWdhdGlvbiIsImNsaWVudFdpZHRoIiwicG9wQXJ0aWNsZXNTd2lwZXIiLCI3MDAiLCJzbGlkZXJJbml0IiwiMTQ0MCIsInN3aXBlckNvbnRhaW5lciIsImxvb3BBZGRpdGlvbmFsU2xpZGVzIiwic3dpcGVyV3JhcHBlciIsInJlbW92ZUF0dHJpYnV0ZSIsIjYwMCIsIml0ZW0iLCJzd2lwZXJEZXN0cm95IiwiYm9keSIsImJyZWFrcG9pbnRzIiwiNjIwIiwiNzY4IiwidGltZW91dCIsIndpbmRvdyIsInBvcHVwTGlua3MiLCJwb3B1cExpbmsiLCJwb3B1cE5hbWUiLCJjdXJyZW50UG9wdXAiLCJkZXN0cm95IiwiZGF0YSIsInN3aXBlciIsImNoaWxkTm9kZXMiLCJmb3JFYWNoIiwic3R5bGUiLCJwb3B1cENsb3NlSWNvbiIsImxvY2tQYWRkaW5nIiwicG9wdXBBY3RpdmUiLCJfbG9vcCIsImdldEF0dHJpYnV0ZSIsInJlcGxhY2UiLCJnZXRFbGVtZW50QnlJZCIsInVubG9jayIsInBhZGRpbmdSaWdodCIsImxvY2tQYWRkaW5nVmFsdWUiLCJpbm5lcldpZHRoIiwib2Zmc2V0V2lkdGgiLCJzZXRUaW1lb3V0IiwiYm9keUxvY2siLCJwb3B1cENsb3NlIiwiX2xvb3AyIiwiZWwiLCJkb1VubG9jayIsImFyZ3VtZW50cyIsInVuZGVmaW5lZCIsInJlc2V0IiwiYm9keVVubG9jayIsIndoaWNoIl0sIm1hcHBpbmdzIjoiYUFFQUEsU0FBU0MsaUJBQWlCLG9CQUFvQixXQVF6QyxJQUFNQyxFQUFtQkYsU0FBU0csY0FBYyxxQkFDMUNDLEVBQW9CSixTQUFTRyxjQUFjLHNCQUUvQ0UsRUFBZ0JBLFNBQWNKLGNBQWlCLCtCQUNoREQsU0FBQUcsY0FBQSx3Q0FFbUJHLEVBQU9MLGlCQUExQixTQUFBLFdBSERNLFFBQUFDLElBQUEsU0FXRU4sRUFBRk8sVUFBcUJQLE9BQUFBLGtCQUNwQkssRUFBQUUsVUFBQUgsT0FBQSxzQkFZbUJOLEVBQVNVLGlCQUYxQixTQUFBLFdBVkZILFFBQVFDLElBQUksU0FjVkcsRUFBU0MsVUFBVEMsT0FBNEIscUJBUGhDLFNBQW9CQyxFQUFRQyxFQUFpQkMsRUFBY0MsR0FHdkQsSUFBSUMsRUFBWWxCLFNBQVNVLGlCQUFpQkksR0FlMUNLLEVBQTRCbkIsU0FBQUcsY0FBQWEsR0FDcEJJLEVBQWNYLFNBQVVZLGlCQUE1QkosR0FFSUcsU0FBQUEsRUFBd0JFLEdBQzNCLElBQUEsSUFBQUMsRUFBQUMsRUFBQUQsRUFBQUgsRUFBQUssT0FBQUYsSUFHTEgsRUFBQUcsR0FBQWQsVUFBQUksT0FBQSxRQWZRTyxFQUFXRyxHQUFHZCxVQUFVYSxJQUFJLFFBS3BDVixFQUFlLEdBV2ZPLEVB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QW1EbEJxRSxHQUFTLEVBQ1RLLFlBQVcsV0FDUEwsR0FBUyxJQXJESyxLQXlEdEJsRixTQUFTQyxpQkFBaUIsV0FBVyxTQUFVeUIsR0FDMUIsSUFBYkEsRUFBSXVFLE9BRUpSLEVBRG9CekYsU0FBU0csY0FBYyIsImZpbGUiOiJjb21tb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgIFxyXG4gICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgICAvLz09PT09PT18ICAgSU1QT1JUU1xyXG4gICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgICBcclxuICAgIFx0Y29uc3QgY2F0YWxvZ0J1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5qcy1oYW1idXJnZXItYnRuJyk7XHJcbiAgICBcdGNvbnN0IGhhbWJ1cmdlck1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuanMtaGFtYnVyZ2VyLW1lbnUnKTtcclxuICAgIFx0Y29uc3QgaGFtYnVyZ2VyQmFja0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oYW1idXJnZXJfX2JhY2stYnRuLW1vYmlsZScpO1xyXG4gICAgXHRjb25zdCBoYW1iZXJnZXJDbG9zZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfX2hhbWJ1cmdlci1idG4tbW9iaWxlLmNoYW5nZScpO1xyXG4gICAgXHRcclxuICAgIFx0ISFjYXRhbG9nQnV0dG9uICYgY2F0YWxvZ0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgIFx0XHRjb25zb2xlLmxvZygnY2xpY2snKVxyXG4gICAgXHRcdGhhbWJ1cmdlck1lbnUuY2xhc3NMaXN0LnRvZ2dsZSgnaGFtYnVyZ2VyLXNob3cnKTtcclxuICAgIFx0XHRzaXRlQm9keS5jbGFzc0xpc3QudG9nZ2xlKCdib2R5X19uby1zY3JvbGwnKTtcclxuICAgIFxyXG4gICAgXHRcclxuICAgIFx0XHJcbiAgICBcdH0pO1xyXG4gICAgXHJcbiAgICBcclxuICAgIFx0XHJcbiAgICBcdCEhaGFtYnVyZ2VyQmFja0J0biAmIGhhbWJ1cmdlckJhY2tCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICBcdFx0Y29uc29sZS5sb2coJ2NsaWNrJylcclxuICAgIFx0XHRoYW1idXJnZXJNZW51LmNsYXNzTGlzdC5yZW1vdmUoJ2hhbWJ1cmdlci1zaG93Jyk7XHJcbiAgICBcdH0pO1xyXG4gICAgXHJcbiAgICBcdFxyXG4gICAgXHJcbiAgICBcclxuICAgIGZ1bmN0aW9uIHRhYk1vZHVsZSAoYnV0dG9uLCBidXR0b25Db250YWluZXIsIGJ0bkNvbnRhaW5lciwgdGFiKSB7XHJcbiAgICBcclxuICAgICAgICAvL9C90YPQttC90L4g0L3QsNC50YLQuCDQutC90L7Qv9C60LgsINCx0LvQvtC6INC60L7QvdGC0LXQvdGC0LAg0Lgg0LHQu9C+0LogYyDQutC90L7Qv9C60LDQvNC4XHJcbiAgICAgICAgbGV0IHRhYkJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYnV0dG9uKSxcclxuICAgICAgICAgICAgYnV0dG9uc0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYnRuQ29udGFpbmVyKSxcclxuICAgICAgICAgICAgdGFiQ29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGFiKTtcclxuICAgIFxyXG4gICAgICAgIGZ1bmN0aW9uIGhpZGVUYWJDb250ZW50IChhKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSBhOyBpPCB0YWJDb250ZW50Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB0YWJDb250ZW50W2ldLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcclxuICAgICAgICAgICAgICAgIHRhYkNvbnRlbnRbaV0uY2xhc3NMaXN0LmFkZCgnaGlkZScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgLy/RgdC60YDRi9Cy0LDQtdC8INCy0YHQtSDRgtCw0LHRiywg0LrRgNC+0LzQtSDQv9C10YDQstC+0LPQvlxyXG4gICAgICAgIGhpZGVUYWJDb250ZW50KDEpO1xyXG4gICAgXHJcbiAgICAgICAgLy/Qv9C+0LrQsNC3INC+0L/RgNC10LTQtdC70LXQvdC90L7Qs9C+INGC0LDQsdCwXHJcbiAgICAgICAgZnVuY3Rpb24gc2hvd1RhYkNvbnRlbnQgKGIpIHtcclxuICAgICAgICAgICAgaWYgKHRhYkNvbnRlbnRbYl0uY2xhc3NMaXN0LmNvbnRhaW5zKCdoaWRlJykpIHtcclxuICAgICAgICAgICAgICAgIHRhYkNvbnRlbnRbYl0uY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpO1xyXG4gICAgICAgICAgICAgICAgdGFiQ29udGVudFtiXS5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAvL9C+0LHRgNCw0LHQvtGC0YfQuNC6INC60LvQuNC60LBcclxuICAgICAgICBidXR0b25zQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2dCkge1xyXG4gICAgICAgICAgICBsZXQgdGFyZ2V0ID0gZXZ0LnRhcmdldDtcclxuICAgIFx0XHRjb25zb2xlLmxvZyh0YXJnZXQsICEhdGFyZ2V0LmNsb3Nlc3QoYnV0dG9uKSlcclxuICAgICAgICAgICAgaWYodGFyZ2V0LmNsb3Nlc3QoYnV0dG9uQ29udGFpbmVyKXx8IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoYnV0dG9uQ29udGFpbmVyKSkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGk8dGFiQnV0dG9uLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldCA9PSB0YWJCdXR0b25baV0pIHtcclxuICAgIFx0XHRcdFx0XHRjb25zb2xlLmxvZyh0YWJCdXR0b25baV0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVUYWJDb250ZW50KDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaG93VGFiQ29udGVudChpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgIFxyXG4gICAgICAgIH0pXHJcbiAgICBcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICBcclxuICAgICAgICB0YWJNb2R1bGUoJy5oYW1idXJnZXJfX2xlZnQtbWVudS1pdGVtLWxpbmsnLCAnLmhhbWJ1cmdlcl9fbGVmdC1tZW51LWl0ZW0nLCAnLmhhbWJ1cmdlcl9fbGVmdC1tZW51JywgJy5oYW1idXJnZXJfX3JpZ2h0LW1lbnUtaXRlbScpO1xyXG4gICAgXHJcbiAgICBcclxuICAgIFxyXG4gICAgXHRjb25zdCBoZWFkZXJMb2NhdGlvbkxpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX19sb2NhdGlvbicpO1xyXG4gICAgY29uc3QgaGVhZGVyTG9jYXRpb25Qb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfX2xvY2F0aW9uLXBvcHVwJyk7XHJcbiAgICBcclxuICAgICEhaGVhZGVyTG9jYXRpb25MaW5rICYmIGhlYWRlckxvY2F0aW9uTGluay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGhlYWRlckxvY2F0aW9uUG9wdXAuY2xhc3NMaXN0LnRvZ2dsZSgnaGVhZGVyX19sb2NhdGlvbi1wb3B1cC0tc2hvdycpO1xyXG4gICAgfSlcclxuICAgIFxyXG4gICAgXHJcbiAgICBcclxuICAgIFxyXG4gICAgY29uc3QgaGVhZGVyQnV0dG9uTW9iaWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9faGFtYnVyZ2VyLWJ0bi1tb2JpbGUnKTtcclxuICAgIGNvbnN0IG1lbnVDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX19uYXZpZ2F0aW9uLWNvbnRhaW5lcicpO1xyXG4gICAgY29uc3QgbWFpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ21haW4nKTtcclxuICAgIGNvbnN0IHNpdGVCb2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpO1xyXG4gICAgIFxyXG4gICAgXHJcbiAgICBcclxuICAgIFxyXG4gICAgY29uc3QgdG9vZ2xlSGFtYnVyZ2VyPSgpID0+IHtcclxuICAgICAgICBoZWFkZXJCdXR0b25Nb2JpbGUuY2xhc3NMaXN0LnRvZ2dsZShcImNoYW5nZVwiKTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIGNvbnN0IHNob3dNZW51ID0gKCkgPT4ge1xyXG4gICAgICAgIG1lbnVDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnc2hvdycpO1xyXG4gICAgICAgIHNpdGVCb2R5LmNsYXNzTGlzdC50b2dnbGUoJ2JvZHlfX25vLXNjcm9sbCcpO1xyXG4gICAgXHJcbiAgICB9XHJcbiAgICBcclxuICAgIFxyXG4gICAgISFoZWFkZXJCdXR0b25Nb2JpbGUgJiYgaGVhZGVyQnV0dG9uTW9iaWxlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgdG9vZ2xlSGFtYnVyZ2VyKCk7XHJcbiAgICAgICAgc2hvd01lbnUoKTtcclxuICAgIFxyXG4gICAgXHRoYW1idXJnZXJNZW51LmNsYXNzTGlzdC5yZW1vdmUoJ2hhbWJ1cmdlci1zaG93Jyk7XHJcbiAgICBcclxuICAgIFx0ICAvKiAgaWYobWVudUNvbnRhaW5lci5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3cnKSkge1xyXG4gICAgICAgICAgICBtYWluLnN0eWxlLmRpc3BsYXkgPSAgJ25vbmUnO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG1haW4uc3R5bGUuZGlzcGxheSA9ICAnYmxvY2snO1xyXG4gICAgICAgIH0gKi9cclxuICAgIFxyXG4gICAgXHRcclxuICAgIFxyXG4gICAgXHJcbiAgICBcclxuICAgIH0pXHJcbiAgICBcclxuICAgIC8qIFx0Y29uc3QgbW9iaWxlQ2F0YWxvZ0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oYW1idXJlci1idG4tLW1vYmlsZScpO1xyXG4gICAgXHQhIW1vYmlsZUNhdGFsb2dCdG4gJiBtb2JpbGVDYXRhbG9nQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgXHRcdGNvbnNvbGUubG9nKCdjbGljaycpXHJcbiAgICBcdFx0aGFtYnVyZ2VyTWVudS5jbGFzc0xpc3QudG9nZ2xlKCcubW9iaWxlLW1lbnUtLXNob3cgJyk7XHJcbiAgICBcdH0pXHJcbiAgICAgKi9cclxuICAgIFxyXG4gICAgXHJcbiAgICAvKiBcdGNvbnN0IGxlZnRNZW51SXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaGFtYnVyZ2VyX19sZWZ0LW1lbnUtaXRlbScpXHJcbiAgICBcdGNvbnN0IHJpZ2h0TWVudUNvbnRhaW5lckl0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmhhbWJ1cmdlcl9fcmlnaHQtbWVudS1pdGVtJylcclxuICAgIFxyXG4gICAgXHRjb25zdCBoaWRlUmlnaHRNZW51SXRlbXMgPSAoKSA9PiB7XHJcbiAgICBcdFx0cmlnaHRNZW51Q29udGFpbmVySXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgIFx0XHRcdGl0ZW0uc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgIFx0XHR9KVxyXG4gICAgXHR9XHJcbiAgICBcclxuICAgIFxyXG4gICAgXHRsZWZ0TWVudUl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICBcdFx0aXRlbS5xdWVyeVNlbGVjdG9yKCdhJykuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgKGUpID0+IHtcclxuICAgIFx0XHRcdGhpZGVSaWdodE1lbnVJdGVtcygpO1xyXG4gICAgXHRcdFx0bGV0IGluZGV4ID0gZS50YXJnZXQuaHJlZjtcclxuICAgIFx0XHRcdGNvbnNvbGUubG9nKGluZGV4KVxyXG4gICAgXHJcbiAgICBcdFx0fSlcclxuICAgIFx0fSlcclxuICAgIFx0bGVmdE1lbnVJdGVtc1swXS5jbGFzc0xpc3QuYWRkKCdzZWxlY3QnKTtcclxuICAgIFx0cmlnaHRNZW51Q29udGFpbmVySXRlbXNbMF0uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICBcclxuICAgIFxyXG4gICAgXHJcbiAgICBcdC8qXHJcbiAgICBcdCQoJy50YWItbmF2IGEnKS5tb3VzZW92ZXIoZnVuY3Rpb24oKXsgXHJcbiAgICBcdCAgJCgnLnRhYi1wYW5lbHM+ZGl2JykuaGlkZSgpLmZpbHRlcih0aGlzLmhhc2gpLnNob3coKTtcclxuICAgIFx0ICAkKCcudGFiLW5hdiBsaScpLnJlbW92ZUNsYXNzKCdzZWxlY3QnKTsgXHJcbiAgICBcdCAgJCh0aGlzKS5wYXJlbnQoKS5hZGRDbGFzcygnc2VsZWN0Jyk7XHJcbiAgICBcdCAgcmV0dXJuIChmYWxzZSk7XHJcbiAgICBcdH0pXHJcbiAgICAgICAqL1xyXG4gICAgXHJcbiAgICBcclxuICAgIFxyXG4gICAgXHJcbiAgICAvKiBcclxuICAgIFxyXG4gICAgXHJcbiAgICBcdGNvbnN0IGNhdGFsb2dCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuanMtaGFtYnVyZ2VyLWJ0bicpO1xyXG4gICAgXHRjb25zdCBoYW1idXJnZXJNZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLWhhbWJ1cmdlci1tZW51Jyk7XHJcbiAgICBcdFxyXG4gICAgXHQhIWNhdGFsb2dCdXR0b24gJiBjYXRhbG9nQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgXHRcdGhhbWJ1cmdlck1lbnUuY2xhc3NMaXN0LnRvZ2dsZSgnaGFtYnVyZ2VyLXNob3cnKTtcclxuICAgIFxyXG4gICAgXHJcbiAgICBcdFx0Y29uc3QgbGVmdE1lbnVTd2lwZXIgPSBuZXcgU3dpcGVyKCcuaGFtYnVyZ2VyX19sZWZ0LW1lbnUnLCB7XHJcbiAgICBcdFx0XHRkaXJlY3Rpb246ICd2ZXJ0aWNhbCcsXHJcbiAgICBcdFx0XHRzbGlkZXNQZXJWaWV3OiAxLFxyXG4gICAgXHRcdCAgIHNsaWRlc1BlclZpZXc6ICdhdXRvJyxcclxuICAgIFx0XHQgICBhbGxvd1RvdWNoTW92ZTogZmFsc2UsXHJcbiAgICBcdFx0ICBsb29wOiBmYWxzZSxcclxuICAgIFx0XHQgIHNsaWRlQWN0aXZlQ2xhc3M6ICdzd2lwZXItc2xpZGUtYWN0aXZlJyxcclxuICAgIFx0XHQgICBcdCBcclxuICAgIFx0XHQgICBzY3JvbGxiYXI6IHtcclxuICAgIFx0XHRcdCBlbDogJy5zd2lwZXItc2Nyb2xsYmFyJyxcclxuICAgIFx0XHRcdCBkcmFnZ2FibGU6IHRydWUsXHJcbiAgICBcdFx0XHQgaGlkZTogdHJ1ZSxcclxuICAgIFx0XHQgICB9LFxyXG4gICAgXHJcbiAgICBcclxuICAgIFx0XHQgICBcclxuICAgIFx0XHQgfSk7XHJcbiAgICBcclxuICAgIFx0XHRcclxuICAgIFx0XHQgY29uc3QgbGVmdFN3aXBlclNsaWRlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5oYW1idXJnZXJfX2xlZnQtbWVudSAuc3dpcGVyLXdyYXBwZXIgLnN3aXBlci1zbGlkZScpO1xyXG4gICAgXHRcdCBsZWZ0TWVudVN3aXBlci5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgXHRcdFx0bGVmdFN3aXBlclNsaWRlcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgXHRcdFx0XHRpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ3N3aXBlci1zbGlkZS1hY3RpdmUnKTtcclxuICAgIFx0XHRcdH0pXHJcbiAgICBcdFx0XHQgbGV0IHRhcmdldCA9IGUudGFyZ2V0O1xyXG4gICAgXHRcdFx0IHRhcmdldC5jbGFzc0xpc3QuYWRkKCdzd2lwZXItc2xpZGUtYWN0aXZlJylcclxuICAgIFx0XHQgIH0pO1xyXG4gICAgXHJcbiAgICBcdFx0ICBcclxuICAgIFxyXG4gICAgXHJcbiAgICBcclxuICAgIFxyXG4gICAgXHRcdCBcclxuICAgIFx0IFxyXG4gICAgXHRcdCBjb25zdCByaWdodE1lbnVTd2lwZXIgPSBuZXcgU3dpcGVyKCcuaGFtYnVyZ2VyX19yaWdodC1tZW51Jywge1xyXG4gICAgXHRcdCAgIFxyXG4gICAgXHRcdCAgIHNsaWRlc1BlclZpZXc6IDEsXHJcbiAgICBcdFx0ICAgc3BhY2VCZXR3ZWVuOiA1MCxcclxuICAgIFx0XHQgICBkaXJlY3Rpb246ICd2ZXJ0aWNhbCcsXHJcbiAgICBcdFx0ICAgYWxsb3dUb3VjaE1vdmU6IGZhbHNlLFxyXG4gICAgXHRcdFx0IGxvb3A6IGZhbHNlLFxyXG4gICAgXHRcdFx0IHRodW1iczoge1xyXG4gICAgXHRcdFx0IHN3aXBlcjogbGVmdE1lbnVTd2lwZXIsXHJcbiAgICBcdFx0XHQgfSxcclxuICAgIFx0IFxyXG4gICAgXHQgXHJcbiAgICBcdCBcclxuICAgIFx0XHQgfSk7XHJcbiAgICBcdH0pXHJcbiAgICBcdFxyXG4gICAgXHJcbiAgICBcclxuICAgIFx0XHJcbiAgICBcdFxyXG4gICAgXHQgKi9cclxuICAgIGNvbnN0IG1haW5TbGlkZXJzd2lwZXIgPSBuZXcgU3dpcGVyKCcubWFpbl9fc2xpZGVyLXN3aXBlcicsIHtcclxuICAgICAgICAvLyBPcHRpb25hbCBwYXJhbWV0ZXJzXHJcbiAgICAgICAgZGlyZWN0aW9uOiAnaG9yaXpvbnRhbCcsXHJcbiAgICAgICAgbG9vcDogdHJ1ZSxcclxuICAgICAgXHJcbiAgICBcclxuICAgICAgICAvLyBOYXZpZ2F0aW9uIGFycm93c1xyXG4gICAgICAgIG5hdmlnYXRpb246IHtcclxuICAgICAgICAgIG5leHRFbDogJy5tYWluX19zbGlkZXItYnV0dG9uLW5leHQnLFxyXG4gICAgICAgICAgcHJldkVsOiAnLm1haW5fX3NsaWRlci1idXR0b24tcHJldicsXHJcbiAgICAgICAgfSxcclxuICAgICAgXHJcbiAgICAgIH0pO1xyXG4gICAgY29uc3QgcG9wV29ya3NTd2lwZXIgPSBuZXcgU3dpcGVyKCcucG9wLXdvcmtzX19zbGlkZXItc3dpcGVyJywge1xyXG4gICAgICAgIC8vIE9wdGlvbmFsIHBhcmFtZXRlcnNcclxuICAgICAgICBkaXJlY3Rpb246ICdob3Jpem9udGFsJyxcclxuICAgICAgICBsb29wOiB0cnVlLFxyXG4gICAgXHJcbiAgICAgICAgLy8gRGVmYXVsdCBwYXJhbWV0ZXJzXHJcbiAgICAgICAgc2xpZGVzUGVyVmlldzogMyxcclxuICAgICAgICBzcGFjZUJldHdlZW46IDI0LFxyXG4gICAgICAgXHJcbiAgICAgIFxyXG4gICAgXHJcbiAgICAgICAgLy8gTmF2aWdhdGlvbiBhcnJvd3NcclxuICAgICAgICBuYXZpZ2F0aW9uOiB7XHJcbiAgICAgICAgICBuZXh0RWw6ICcucG9wLXdvcmtzX19zbGlkZXItYnV0dG9uLW5leHQnLFxyXG4gICAgICAgICAgcHJldkVsOiAnLnBvcC13b3Jrc19fc2xpZGVyLWJ1dHRvbi1wcmV2JyxcclxuICAgICAgICB9LFxyXG4gICAgXHJcbiAgICAgICAgYnJlYWtwb2ludHM6IHtcclxuICAgICAgICAgIC8vIHdoZW4gd2luZG93IHdpZHRoIGlzID49IDQxNHhcclxuICAgICAgICAgIDcwMDoge1xyXG4gICAgICAgICAgICBzbGlkZXNQZXJWaWV3OiAxLFxyXG4gICAgICAgICAgICBzcGFjZUJldHdlZW46IDAsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgLy8gd2hlbiB3aW5kb3cgd2lkdGggaXMgPj0gNDgwcHhcclxuICAgICAgICAgIDExNTA6IHtcclxuICAgICAgICAgICAgc2xpZGVzUGVyVmlldzogMixcclxuICAgICAgICAgICAgc3BhY2VCZXR3ZWVuOiAyNCxcclxuICAgICAgICAgIH0sXHJcbiAgICBcclxuICAgIFxyXG4gICAgICAgICAgMTQ0MDoge1xyXG4gICAgICAgICAgICBzbGlkZXNQZXJWaWV3OiAzLFxyXG4gICAgICAgICAgICBzcGFjZUJldHdlZW46IDI0LFxyXG4gICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgfVxyXG4gICAgICBcclxuICAgICAgfSk7XHJcbiAgICBjb25zdCBuZXdWaWRlb3NTd2lwZXIgPSBuZXcgU3dpcGVyKCcubmV3LXZpZGVvc19fc2xpZGVyLXN3aXBlcicsIHtcclxuICAgICAgICAvLyBPcHRpb25hbCBwYXJhbWV0ZXJzXHJcbiAgICAgICAgZGlyZWN0aW9uOiAnaG9yaXpvbnRhbCcsXHJcbiAgICAgICAgbG9vcDogdHJ1ZSxcclxuICAgICAgICBzbGlkZXNQZXJWaWV3OiA0LFxyXG4gICAgICAgIHNwYWNlQmV0d2VlbjogMjQsXHJcbiAgICAgICAgbG9vcEFkZGl0aW9uYWxTbGlkZXM6IDMsXHJcbiAgICAgIFxyXG4gICAgXHJcbiAgICAgICAgLy8gTmF2aWdhdGlvbiBhcnJvd3NcclxuICAgICAgICBuYXZpZ2F0aW9uOiB7XHJcbiAgICAgICAgICBuZXh0RWw6ICcubmV3LXZpZGVvc19fc2xpZGVyLWJ1dHRvbi1uZXh0JyxcclxuICAgICAgICAgIHByZXZFbDogJy5uZXctdmlkZW9zX19zbGlkZXItYnV0dG9uLXByZXYnLFxyXG4gICAgICAgIH0sXHJcbiAgICBcclxuICAgIFxyXG4gICAgICAgIGJyZWFrcG9pbnRzOiB7XHJcbiAgICAgICAgICAvLyB3aGVuIHdpbmRvdyB3aWR0aCBpcyA+PSA0MTRcclxuICAgICAgICAgIDYwMDoge1xyXG4gICAgICAgICAgICBzbGlkZXNQZXJWaWV3OiAxLjM2LFxyXG4gICAgICAgICAgICBzcGFjZUJldHdlZW46IDI0XHJcbiAgICAgICAgICB9LFxyXG4gICAgXHJcbiAgICAgICAgICA4MDA6IHtcclxuICAgICAgICAgICAgc2xpZGVzUGVyVmlldzogMixcclxuICAgICAgICAgICAgc3BhY2VCZXR3ZWVuOiAyNFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIC8vIHdoZW4gd2luZG93IHdpZHRoIGlzID49IDEwMDBcclxuICAgICAgICAgIDExNTA6IHtcclxuICAgICAgICAgICAgc2xpZGVzUGVyVmlldzogMyxcclxuICAgICAgICAgICAgc3BhY2VCZXR3ZWVuOiAyNFxyXG4gICAgICAgICAgfSxcclxuICAgIFxyXG4gICAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIH0pO1xyXG4gICAgbGV0IHsgY2xpZW50V2lkdGggfSA9IGRvY3VtZW50LmJvZHk7XHJcbiAgICBjb25zdCBzd2lwZXJDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wLWFydGljbGVzX19pdGVtcy1zd2lwZXInKTtcclxuICAgIGNvbnN0IHN3aXBlcldyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wLWFydGljbGVzX19pdGVtcycpO1xyXG4gICAgbGV0IHBvcEFydGljbGVzU3dpcGVyO1xyXG4gICAgY29uc3QgTUFYX01PQklMRV9XSURUSCA9IDc2OTtcclxuICAgIFxyXG4gICAgY29uc3Qgc2xpZGVySW5pdCA9ICgpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZygnc2xpZGVySW5pdCcpXHJcbiAgICAgICAgcG9wQXJ0aWNsZXNTd2lwZXIgID0gbmV3IFN3aXBlcignLnBvcC1hcnRpY2xlc19faXRlbXMtc3dpcGVyJywge1xyXG4gICAgICAgICAgICAvLyBPcHRpb25hbCBwYXJhbWV0ZXJzXHJcbiAgICAgICAgICAgIGRpcmVjdGlvbjogJ2hvcml6b250YWwnLFxyXG4gICAgICAgICAgICBsb29wOiB0cnVlLFxyXG4gICAgICAgICAgICBzbGlkZXNQZXJWaWV3OiAxLjM1LFxyXG4gICAgICAgICAgICBzcGFjZUJldHdlZW46IDIwLFxyXG4gICAgICAgICAgICBsb29wQWRkaXRpb25hbFNsaWRlczogMyxcclxuICAgIFxyXG4gICAgICAgICAgICBicmVha3BvaW50czoge1xyXG4gICAgICAgICAgICAgICAgLy8gd2hlbiB3aW5kb3cgd2lkdGggaXMgPj0gNDE0eFxyXG4gICAgICAgICAgICAgICAgNjIwOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2xpZGVzUGVyVmlldzogMS4zNSxcclxuICAgICAgICAgICAgICAgICAgICBzcGFjZUJldHdlZW46IDIwLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIC8vIHdoZW4gd2luZG93IHdpZHRoIGlzID49IDQ4MHB4XHJcbiAgICAgICAgICAgICAgICA3Njg6IHtcclxuICAgICAgICAgICAgICAgICAgc2xpZGVzUGVyVmlldzogMixcclxuICAgICAgICAgICAgICAgICAgc3BhY2VCZXR3ZWVuOiAyNCxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgIFxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgIFxyXG4gICAgICAgIH0pXHJcbiAgICBcclxuICAgICAgXHJcbiAgICAgIFxyXG4gICAgXHJcbiAgICAgIHN3aXBlckNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKCdwb3AtYXJ0aWNsZXMtLW5vLXN3aXBlcicpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCBzd2lwZXJEZXN0cm95ID0gKCkgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdzd2lwZXJEZXN0cm95JywgcG9wQXJ0aWNsZXNTd2lwZXIpXHJcbiAgICAgICAgcG9wQXJ0aWNsZXNTd2lwZXIuZGVzdHJveSgpO1xyXG4gICAgICAgIHBvcEFydGljbGVzU3dpcGVyLmRhdGEoJ3N3aXBlcicpLmRlc3Ryb3koKTtcclxuICAgICAgICBwb3BBcnRpY2xlc1N3aXBlci5zd2lwZXIoKS5kZXN0cm95KCk7XHJcbiAgICBcclxuICAgICAgICBwb3BBcnRpY2xlc1N3aXBlciA9IG51bGw7XHJcbiAgICAgICAgc3dpcGVyQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3BvcC1hcnRpY2xlcy0tbm8tc3dpcGVyJyk7XHJcbiAgICAgICAgLyogc3dpcGVyV3JhcHBlci5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlM2QoMHB4LCAwcHgsIDBweCk7JzsgKi9cclxuICAgICAgICBzd2lwZXJXcmFwcGVyLnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKTtcclxuICAgICAgICBzd2lwZXJXcmFwcGVyLmNoaWxkTm9kZXMuZm9yRWFjaChpdGVtID0+IGl0ZW0ucmVtb3ZlQXR0cmlidXRlKCdzdHlsZScpKVxyXG4gICAgICAgIHN3aXBlcldyYXBwZXIuc3R5bGUgPSAnICc7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcbiAgICBcclxuICAgIFxyXG4gICAgaWYgKGNsaWVudFdpZHRoPCBNQVhfTU9CSUxFX1dJRFRIICYmICFzd2lwZXJDb250YWluZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdzd2lwZXItY29udGFpbmVyLWluaXRpYWxpemVkJykpIHtcclxuICAgICAgICBzbGlkZXJJbml0KCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IHJlc2l6ZUhhbmRsZXJTbGlkZXIgPSAoKSA9PiB7XHJcbiAgICAgICAgbGV0IHsgY2xpZW50V2lkdGggfSA9IGRvY3VtZW50LmJvZHk7XHJcbiAgICAgICAgY29uc29sZS5sb2coY2xpZW50V2lkdGgpO1xyXG4gICAgICAgIGlmIChjbGllbnRXaWR0aDwgTUFYX01PQklMRV9XSURUSCkge1xyXG4gICAgICAgICAgICBzbGlkZXJJbml0KCk7XHJcbiAgICAgICAgfSBlbHNlIC8qIGlmIChjbGllbnRXaWR0aCA+PSBNQVhfTU9CSUxFX1dJRFRIICYmIHN3aXBlckNvbnRhaW5lci5jbGFzc0xpc3QuY29udGFpbnMoJ3N3aXBlci1jb250YWluZXItaW5pdGlhbGl6ZWQnKSkgKi8ge1xyXG4gICAgXHJcbiAgICAgICAgICAgIHN3aXBlckRlc3Ryb3koKTsgXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgcmVzaXplSGFuZGxlclNsaWRlcik7XHJcbiAgICBcclxuICAgIFxyXG4gICAgXHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGNsaWVudFdpZHRoKTtcclxuICAgIC8qIGNvbnN0IGhlYWRlckxvY2F0aW9uTGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfX2xvY2F0aW9uJyk7XHJcbiAgICBjb25zdCBoZWFkZXJMb2NhdGlvblBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9fbG9jYXRpb24tcG9wdXAnKTtcclxuICAgIFxyXG4gICAgISFoZWFkZXJMb2NhdGlvbkxpbmsgJiYgaGVhZGVyTG9jYXRpb25MaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgaGVhZGVyTG9jYXRpb25Qb3B1cC5jbGFzc0xpc3QudG9nZ2xlKCdoZWFkZXJfX2xvY2F0aW9uLXBvcHVwLS1zaG93Jyk7XHJcbiAgICB9KVxyXG4gICAgXHJcbiAgICBcclxuICAgIFxyXG4gICAgXHJcbiAgICBjb25zdCBoZWFkZXJCdXR0b25Nb2JpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX19oYW1idXJnZXItYnRuLW1vYmlsZScpO1xyXG4gICAgY29uc3QgbWVudUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfX25hdmlnYXRpb24tY29udGFpbmVyJyk7XHJcbiAgICBjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbWFpbicpO1xyXG4gICAgY29uc3Qgc2l0ZUJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XHJcbiAgICAgXHJcbiAgICBcclxuICAgIFxyXG4gICAgXHJcbiAgICBjb25zdCB0b29nbGVIYW1idXJnZXI9KCkgPT4ge1xyXG4gICAgICAgIGhlYWRlckJ1dHRvbk1vYmlsZS5jbGFzc0xpc3QudG9nZ2xlKFwiY2hhbmdlXCIpO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgY29uc3Qgc2hvd01lbnUgPSAoKSA9PiB7XHJcbiAgICAgICAgbWVudUNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKCdzaG93Jyk7XHJcbiAgICAgIFxyXG4gICAgXHJcbiAgICB9XHJcbiAgICBcclxuICAgIFxyXG4gICAgISFoZWFkZXJCdXR0b25Nb2JpbGUgJiYgaGVhZGVyQnV0dG9uTW9iaWxlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgdG9vZ2xlSGFtYnVyZ2VyKCk7XHJcbiAgICAgICAgc2hvd01lbnUoKTtcclxuICAgIFxyXG4gICAgXHJcbiAgICAgIFxyXG4gICAgXHJcbiAgICB9KVxyXG4gICAgXHJcbiAgICBcclxuICAgIFxyXG4gICAgICovXHJcbiAgICBcclxuICAgIFxyXG4gICAgICAgIGNvbnN0IHBvcHVwTGlua3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwLWxpbmtcIik7XHJcbiAgICAgICAgY29uc3QgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJib2R5XCIpO1xyXG4gICAgICAgIGNvbnN0IGxvY2tQYWRkaW5nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5sb2NrLXBhZGRpbmdcIik7XHJcbiAgICAgICAgXHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IHVubG9jayA9IHRydWU7IC8v0YfRgtC+0LHRiyDQvdC1INCx0YvQu9C+INC00LLQvtC50L3Ri9GFINC90LDQttCw0YLQuNC5XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgdGltZW91dCA9IDgwMDsgLy8g0KLQsNC50LzQsNGD0YIg0YHRgtC+0LjRgiDRgtCw0LrQvtC5INC20LUg0LrQsNC6INGDINCw0L3QuNC80LDRhtC40Lgg0LIg0YHQuNGN0YHRjdGBLiDQrdGC0L4g0YHQstGP0LfQsNC90L4g0YEg0LHQu9C+0LrQuNGA0L7QstC60L7QuSDRgdGC0YDQvtC40LvQsCDQuCDQtdCz0L4g0LDQtNC10LrQstCw0YLQvdC+0Lkg0YDQsNCx0L7RgtC1XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHBvcHVwTGlua3MubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBvcHVwTGlua3MubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBvcHVwTGluayA9IHBvcHVwTGlua3NbaV07XHJcbiAgICAgICAgICAgICAgICBwb3B1cExpbmsuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChldnQpIHtcclxuICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwb3B1cE5hbWUgPSBwb3B1cExpbmsuZ2V0QXR0cmlidXRlKFwiaHJlZlwiKS5yZXBsYWNlKFwiI1wiLCBcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50UG9wdXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwb3B1cE5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGN1cnJlbnRQb3B1cClcclxuICAgICAgICAgICAgICAgICAgICBwb3B1cE9wZW4oY3VycmVudFBvcHVwKTtcclxuICAgICAgICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgcG9wdXBDbG9zZUljb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNsb3NlLXBvcHVwXCIpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChwb3B1cENsb3NlSWNvbi5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcG9wdXBDbG9zZUljb24ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGVsID0gcG9wdXBDbG9zZUljb25baV07XHJcbiAgICAgICAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGV2dCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvcHVwQ2xvc2UoZWwuY2xvc2VzdChcIi5wb3B1cFwiKSk7IC8vINCa0LvQvtC30LXRgdGCIC0g0Y3RgtC+INCx0LvQuNC20LDQudGI0LjQuSDRgNC+0LTQuNGC0LXQu9GMINGB0YHRi9C70LrQuCDRgSDQutC70LDRgdGB0L7QvCDQv9C+0L/QsNC/LiDQotC+INC10YHRgtGMINCx0YPQtNC10YIg0LfQsNC60YDRi9GCINC/0L7Qv9Cw0L8g0YDRj9C00L7QvCDRgSDQutC70LjQutC90YPRgtC+0Lkg0YHRgdGL0LvQutC+0LksINCwINC90LUg0LrQsNC60L7RhtGC0L4g0LTRgNGD0LPQvtC5LiDQntGCINGB0YHRi9C70LrQuCDRgdC+0LHRi9GC0LjQtSDQstGB0L/Qu9GL0LLRkdGCINC4INGB0YDQsNCx0L7RgtCw0LXRgiDQvdCwINGA0L7QtNC40YLQtdC70LUg0YEg0LrQu9Cw0YHRgdC+0Lwg0L/QvtC/0LDQv1xyXG4gICAgICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvL9GE0YPQvdC60YbQuNGPINC+0YLQutGA0YvRgtC40Y9cclxuICAgICAgICBcclxuICAgICAgICBmdW5jdGlvbiBwb3B1cE9wZW4oY3VycmVudFBvcHVwKSB7XHJcbiAgICAgICAgICAgIC8v0JLQvdCw0YfQsNC70LUg0L/RgNC+0LLQtdGA0LrQsCDQvdCwINGD0LbQtSDQvtGC0LrRgNGL0YLRi9C1INC/0L7Qv9Cw0L/Riywg0YfRgtC+0LHRiyDQt9Cw0LrRgNGL0YLRjCDQuNGFXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50UG9wdXAgJiYgdW5sb2NrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwb3B1cEFjdGl2ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXAub3BlblwiKTtcclxuICAgICAgICAgICAgICAgIGlmIChwb3B1cEFjdGl2ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvcHVwQ2xvc2UocG9wdXBBY3RpdmUsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYm9keUxvY2soKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGN1cnJlbnRQb3B1cC5jbGFzc0xpc3QuYWRkKFwib3BlblwiKTtcclxuICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8v0LfQsNC60YDRi9GC0LjQtSDQv9C+INC60LvQuNC60YMg0LLQvdC1INC+0LHQu9Cw0YHRgtC4INC60L7QvdGC0LXQvdGC0LBcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRQb3B1cC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGV2dCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZXZ0LnRhcmdldC5jbG9zZXN0KFwiLnBvcHVwX19jb250ZW50XCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvcHVwQ2xvc2UoZXZ0LnRhcmdldC5jbG9zZXN0KFwiLnBvcHVwXCIpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICAvL9Ck0KPQndCa0KbQmNCvINCX0JDQmtCg0KvQotCY0K9cclxuICAgICAgICAvL9CSINC30LDQutGA0YvRgtC40Lgg0LzRiyDQvNC+0LbQtdC8INC/0LXRgNC10LTQsNGC0Ywg0YTQvtC70YEg0LTQu9GPINCx0LvQvtC60LjRgNC+0LLQutC4INCx0L7QtNC4LCDQutC+0LPQtNCwINC80Ysg0L7RgtC60YDRi9Cy0LDQtdC8INC/0L7Qv9Cw0L8g0LIg0L/QvtC/0LDQv9C1XHJcbiAgICAgICAgZnVuY3Rpb24gcG9wdXBDbG9zZShwb3B1cEFjdGl2ZSwgZG9VbmxvY2sgPSB0cnVlKSB7XHJcbiAgICAgICAgICAgIGlmIChwb3B1cEFjdGl2ZS5xdWVyeVNlbGVjdG9yKCdmb3JtJykpIHtcclxuICAgICAgICAgICAgICAgIHBvcHVwQWN0aXZlLnF1ZXJ5U2VsZWN0b3IoJ2Zvcm0nKS5yZXNldCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8qIHBvcHVwQWN0aXZlLnF1ZXJ5U2VsZWN0b3IoJ2Zvcm0nKS5yZXNldCgpOyAqL1xyXG4gICAgICAgICAgICBpZiAodW5sb2NrKSB7XHJcbiAgICAgICAgICAgICAgICBwb3B1cEFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKFwib3BlblwiKTtcclxuICAgICAgICAgICAgICAgIGlmIChkb1VubG9jaykge1xyXG4gICAgICAgICAgICAgICAgICAgIGJvZHlVbmxvY2soKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICBmdW5jdGlvbiBib2R5TG9jaygpIHtcclxuICAgICAgICAgICAgLy/QktC90LDRh9Cw0LvQtSDRg9Cx0LjRgNCw0LXRgiDQv9GA0YvQs9Cw0Y7RidC40Lkg0YHQutGA0L7Qu9C7IHdyYXBwZXIg4oCTINGN0YLQviDQtNC40LIg0LLQvdGD0YLRgNC4INCx0L7QtNC4XHJcbiAgICAgICAgICAgIC8qIGNvbnN0IGxvY2tQYWRkaW5nVmFsdWUgPSB3aW5kb3cuaW5uZXJXaWR0aCAtIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud3JhcHBlclwiKS5vZmZzZXRXaWR0aCArIFwicHhcIjsgKi9cclxuICAgICAgICAgICAgY29uc3QgbG9ja1BhZGRpbmdWYWx1ZSA9IHdpbmRvdy5pbm5lcldpZHRoIC0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53cmFwcGVyXCIpLmNsaWVudFdpZHRoICsgXCJweFwiO1xyXG4gICAgICAgIFxyXG4gICAgICAgIFxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyh3aW5kb3cuaW5uZXJXaWR0aCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud3JhcHBlclwiKS5vZmZzZXRXaWR0aCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgIC8v0JvQvtC6INC/0Y3QtNC00LjQvdCzINC00L7QsdCw0LLQu9GP0LXRgiDQvtCx0YrQtdC60YLQsNC8INGBINC/0L7Qt9C40YjQvSDRhNC40LrRgdC0LiDQndCw0L/RgNC40LzQtdGAINGF0Y3QtNGN0YAg0YLQsNC60L7QuS4g0J7QvSDRgdCy0LjQtNCz0LDQtdGC0YHRjy4g0JXQvNGDINC90LDQtNC+INGB0YLQuNC70Ywg0L/QvtC00L/RgNCw0LLQuNGC0YwuXHJcbiAgICAgICAgICAgIGlmIChsb2NrUGFkZGluZy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxvY2tQYWRkaW5nLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWwgPSBsb2NrUGFkZGluZ1tpXTtcclxuICAgICAgICAgICAgICAgICAgICBlbC5zdHlsZS5wYWRkaW5nUmlnaHQgPSBsb2NrUGFkZGluZ1ZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgIGJvZHkuc3R5bGUucGFkZGluZ1JpZ2h0ID0gbG9ja1BhZGRpbmdWYWx1ZTtcclxuICAgICAgICAgICAgYm9keS5jbGFzc0xpc3QuYWRkKFwibG9ja1wiKTtcclxuICAgICAgICBcclxuICAgICAgICAgICAgLy/QntC9INC70L7Rh9C40YIg0L3QsCDQstGA0LXQvNGPINGC0LDQudC80LDRg9GC0LAsINC/0L7RgtC+0LzRgyDRh9GC0L4g0L7QutC90L4g0LfQsNC60YDRi9Cy0LDQtdGC0YHRjyA4MDAg0LzRgS4g0Jgg0YfRgtC+0LHRiyDQstC+INCy0YDQtdC80Y8g0LfQsNC60YDRi9GC0LjRjyDQvdC1INC+0YLQutGA0YvRgtGMINCx0YvQu9C+INC+0LrQvdC+INGB0L3QvtCy0LBcclxuICAgICAgICAgICAgdW5sb2NrID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdW5sb2NrID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSwgdGltZW91dCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIFxyXG4gICAgICAgIC8v0L3QtSDQtNC+INC60L7QvdGG0LBcclxuICAgICAgICBmdW5jdGlvbiBib2R5VW5sb2NrKCkge1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChsb2NrUGFkZGluZy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsb2NrUGFkZGluZy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlbCA9IGxvY2tQYWRkaW5nW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbC5zdHlsZS5wYWRkaW5nUmlnaHQgPSBcIjBweFwiO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJvZHkuc3R5bGUucGFkZGluZ1JpZ2h0ID0gXCIwcHhcIjtcclxuICAgICAgICAgICAgICAgIGJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnbG9jaycpO1xyXG4gICAgICAgICAgICB9LCB0aW1lb3V0KTtcclxuICAgICAgICBcclxuICAgICAgICAgICAgdW5sb2NrID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdW5sb2NrID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSwgdGltZW91dClcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uIChldnQpIHtcclxuICAgICAgICAgICAgaWYgKGV2dC53aGljaCA9PSAyNykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcG9wdXBBY3RpdmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwLm9wZW5cIik7XHJcbiAgICAgICAgICAgICAgICBwb3B1cENsb3NlKHBvcHVwQWN0aXZlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgXHJcblxyXG59KTsiXX0=
